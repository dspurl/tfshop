{"version":3,"file":"view-layer.js","sourceRoot":"","sources":["../../src/base/view-layer.ts"],"names":[],"mappings":";AAAA,OAAO,EACL,OAAO,EACP,OAAO,EACP,SAAS,EACT,GAAG,EACH,IAAI,EACJ,MAAM,EACN,UAAU,EACV,GAAG,EACH,GAAG,EACH,OAAO,EACP,MAAM,EACN,SAAS,EACT,QAAQ,EACR,QAAQ,EACR,MAAM,GACP,MAAM,YAAY,CAAC;AACpB,OAAO,EAAE,IAAI,EAAY,gBAAgB,EAAE,MAAM,eAAe,CAAC;AACjE,OAAO,eAAe,MAAM,2BAA2B,CAAC;AACxD,OAAkB,EAAwB,iBAAiB,EAAE,MAAM,0BAA0B,CAAC;AAC9F,OAAO,EAAE,YAAY,EAAE,MAAM,uBAAuB,CAAC;AAErD,OAAO,eAAoC,MAAM,sBAAsB,CAAC;AAkBxE,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,eAAe,CAAC;AACnD,OAAO,iBAAiB,MAAM,sBAAsB,CAAC;AACrD,OAAO,eAAe,MAAM,oBAAoB,CAAC;AACjD,OAAO,eAAe,MAAM,oBAAoB,CAAC;AACjD,OAAO,KAAsB,MAAM,SAAS,CAAC;AAC7C,OAAO,EAAE,YAAY,EAAE,MAAM,gBAAgB,CAAC;AAE9C,OAAO,IAAI,EAAE,EAAE,SAAS,EAAE,MAAM,cAAc,CAAC;AAC/C,OAAO,EAAE,qBAAqB,EAAE,MAAM,aAAa,CAAC;AAqCpD;IAA6F,6BAAQ;IA4FnG,mBAAY,KAAQ;QAApB,YACE,kBAAM,KAAK,CAAC,SAUb;QAdS,kBAAY,GAAkB,EAAE,CAAC;QACjC,YAAM,GAAgB,EAAE,CAAC;QAIjC,KAAI,CAAC,OAAO,GAAG,KAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;QACtC,KAAI,CAAC,cAAc,GAAG,OAAO,CAAC,EAAE,EAAE,KAAI,CAAC,OAAO,CAAC,CAAC;QAChD,KAAI,CAAC,iBAAiB,GAAG,IAAI,iBAAiB,CAAC;YAC7C,IAAI,EAAE,KAAI;SACX,CAAC,CAAC;QACH,KAAI,CAAC,eAAe,GAAG,IAAI,eAAe,CAAC;YACzC,IAAI,EAAE,KAAI;SACX,CAAC,CAAC;QACH,KAAI,CAAC,eAAe,GAAG,IAAI,eAAe,EAAE,CAAC;;IAC/C,CAAC;IAtGa,2BAAiB,GAA/B;QACE,OAAO;YACL,QAAQ,EAAE,QAAQ;YAClB,KAAK,EAAE;gBACL,OAAO,EAAE,KAAK;gBACd,OAAO,EAAE,MAAM;gBACf,IAAI,EAAE,EAAE;aACT;YACD,WAAW,EAAE;gBACX,OAAO,EAAE,KAAK;gBACd,IAAI,EAAE,EAAE;gBACR,OAAO,EAAE,MAAM;aAChB;YACD,OAAO,EAAE,MAAM;YACf,MAAM,EAAE;gBACN,OAAO,EAAE,IAAI;gBACb,QAAQ,EAAE,eAAe;aAC1B;YACD,OAAO,EAAE;gBACP,OAAO,EAAE,IAAI;gBACb,MAAM,EAAE,IAAI;gBACZ,cAAc,EAAE,IAAI;gBACpB,UAAU,EAAE;oBACV,IAAI,EAAE,GAAG;iBACV;gBACD,MAAM,EAAE,EAAE;aACX;YACD,KAAK,EAAE;gBACL,OAAO,EAAE,IAAI;gBACb,IAAI,EAAE;oBACJ,OAAO,EAAE,KAAK;iBACf;gBACD,IAAI,EAAE;oBACJ,OAAO,EAAE,IAAI;iBACd;gBACD,QAAQ,EAAE;oBACR,OAAO,EAAE,IAAI;iBACd;gBACD,KAAK,EAAE;oBACL,OAAO,EAAE,IAAI;oBACb,UAAU,EAAE,IAAI;oBAChB,QAAQ,EAAE,IAAI;iBACf;gBACD,KAAK,EAAE;oBACL,OAAO,EAAE,KAAK;oBACd,OAAO,EAAE,EAAE;iBACZ;aACF;YACD,KAAK,EAAE;gBACL,OAAO,EAAE,IAAI;gBACb,IAAI,EAAE;oBACJ,OAAO,EAAE,IAAI;iBACd;gBACD,IAAI,EAAE;oBACJ,OAAO,EAAE,KAAK;iBACf;gBACD,QAAQ,EAAE;oBACR,OAAO,EAAE,KAAK;iBACf;gBACD,KAAK,EAAE;oBACL,OAAO,EAAE,IAAI;oBACb,QAAQ,EAAE,IAAI;oBACd,UAAU,EAAE,KAAK;iBAClB;gBACD,KAAK,EAAE;oBACL,UAAU,EAAE,IAAI;oBAChB,OAAO,EAAE,KAAK;oBACd,OAAO,EAAE,EAAE;iBACZ;aACF;YACD,KAAK,EAAE;gBACL,OAAO,EAAE,KAAK;aACf;YACD,YAAY,EAAE,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,EAAE,EAAE,IAAI,EAAE,eAAe,EAAE,EAAE,EAAE,IAAI,EAAE,eAAe,EAAE,CAAC;YACzF,SAAS,EAAE,IAAI;SAChB,CAAC;IACJ,CAAC;IA4BM,8BAAU,GAAjB,UAAkB,KAAiB;QACjC,IAAM,UAAU,GAAG,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC;QACtC,IAAM,OAAO,GAAG,iBAAM,UAAU,YAAC,KAAK,CAAC,CAAC;QACxC,aAAa;QACb,IAAM,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;QACjE,kEAAkE;QAClE,IAAM,YAAY,GAAG,MAAM,CACzB,OAAO,CACL,GAAG,CAAC,CAAC,OAAO,EAAE,cAAc,EAAE,MAAM,CAAC,KAAK,EAAE,cAAc,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,UAAU,CAAC,EAAE,UAAC,GAAG;YACrF,OAAA,GAAG,CAAC,GAAG,EAAE,cAAc,EAAE,EAAE,CAAC;QAA5B,CAA4B,CAC7B,CACF,EACD,UAAC,MAAM,EAAE,GAAG;YACV,IAAM,GAAG,GAAG,SAAS,CAAC,MAAM,EAAE,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,IAAI,KAAK,GAAG,CAAC,IAAI,EAAtB,CAAsB,CAAC,CAAC;YAChE,IAAI,GAAG,IAAI,CAAC,EAAE;gBACZ,MAAM,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;aACvB;YACD,sBAAW,MAAM,GAAE,GAAG,GAAE;QAC1B,CAAC,EACD,EAAE,CACH,CAAC;QACF,OAAO,OAAO,CAAC,EAAE,EAAE,OAAO,EAAE,cAAc,EAAE,UAAU,EAAE,KAAK,EAAE,EAAE,YAAY,cAAA,EAAE,CAAC,CAAC;IACnF,CAAC;IAEM,8BAAU,GAAjB;QACE,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,WAAW,CAAC,CAAC;QAC7C,iBAAM,UAAU,WAAE,CAAC;IACrB,CAAC;IAEM,wBAAI,GAAX;QAAA,iBAsDC;QArDC,iBAAM,IAAI,WAAE,CAAC;QACb,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;QACpE,IAAI,CAAC,MAAM,GAAG;YACZ,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;YACzC,MAAM,EAAE,EAAE;YACV,OAAO,EAAE,EAAE;YACX,OAAO,EAAE;gBACP,SAAS,EAAE,IAAI;aAChB;YACD,IAAI,EAAE,EAAE;YACR,UAAU,EAAE,EAAE,IAAI,EAAE,WAAW,EAAE;YACjC,UAAU,EAAE,EAAE;YACd,WAAW,EAAE,EAAE;YACf,YAAY,EAAE,EAAE;YAChB,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,UAAU,EAAE,EAAE;YACd,OAAO,EAAE,EAAS;YAClB,KAAK,EAAE,EAAE;SACV,CAAC;QAEF,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,CAAC;QAE/B,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,6BAA6B;QAC7B,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,IAAI,CAAC,KAAK,EAAE,CAAC;QACb,IAAI,CAAC,KAAK,EAAE,CAAC;QACb,IAAI,CAAC,IAAI,EAAE,CAAC;QACZ,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,IAAI,CAAC,MAAM,EAAE,CAAC;QACd,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,SAAS,EAAE,CAAC;QAEjB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;QACrC,IAAM,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACtD,IAAI,CAAC,IAAI,GAAG,IAAI,IAAI,CAAC;YACnB,MAAM,EAAE,IAAI;YACZ,MAAM,EAAE,IAAI,CAAC,MAAM;YACnB,eAAe,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE;YAC1C,WAAW,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE;YACtC,eAAe,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE;YAC1C,OAAO,EAAE,IAAI,CAAC,iBAAiB,CAAC,UAAU,EAAE;YAC5C,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,OAAO,EAAE,IAAI,CAAC,MAAM;YACpB,WAAW,EAAE,IAAI,CAAC,aAAa,EAAE;YACjC,MAAM,QAAA;SACP,CAAC,CAAC;QACH,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACzB,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,YAAY,EAAE;YAC1C,KAAI,CAAC,WAAW,EAAE,CAAC;QACrB,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,6BAAS,GAAhB;QACE,iBAAM,SAAS,WAAE,CAAC;QAClB,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACrC,OAAO;SACR;QACD,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,KAAK,MAAM,EAAE;YACnC,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;QACD,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,UAAU,CAAC,CAAC;IAC9C,CAAC;IAEM,+BAAW,GAAlB;;QACE,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACrC,OAAO;SACR;QACO,IAAA,OAAO,GAAK,IAAI,QAAT,CAAU;QACzB,IAAM,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;QAC9E,mBAAmB;QACnB,IAAI,OAAO,CAAC,YAAY,IAAI,OAAO,KAAK,MAAM,EAAE;YAC9C,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;SAC1D;QACD,kBAAkB;QAClB,IAAI,OAAO,KAAK,MAAM,EAAE;YACtB,IAAI,CAAC,iBAAiB,CAAC,kBAAkB,EAAE,CAAC;SAC7C;QACD,IAAI,aAAA,OAAO,CAAC,OAAO,0CAAE,MAAM,0CAAE,QAAQ,KAAI,OAAO,CAAC,OAAO,KAAK,MAAM,EAAE;YACnE,IAAI,CAAC,aAAa,EAAE,CAAC;SACtB;IACH,CAAC;IAED,eAAe;IACR,0BAAM,GAAb;QACE,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,aAAa,CAAC,CAAC;QAC/C,iBAAM,MAAM,WAAE,CAAC;QACP,IAAA,IAAI,GAAK,IAAI,CAAC,OAAO,KAAjB,CAAkB;QAC9B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YAClB,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;SACpB;QACD,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,YAAY,CAAC,CAAC;IAChD,CAAC;IAED,WAAW;IACJ,2BAAO,GAAd;QACE,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;SACpB;IACH,CAAC;IAEM,mCAAe,GAAtB,UAAuB,KAAa;QAClC,OAAO,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;IAC1C,CAAC;IAEM,6BAAS,GAAhB;QACU,IAAA,MAAM,GAAK,IAAI,CAAC,OAAO,OAAjB,CAAkB;QAChC,IAAI,MAAM,EAAE;YACV,OAAO,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;SAC1C;IACH,CAAC;IAEM,6BAAS,GAAhB;QACU,IAAA,MAAM,GAAK,IAAI,CAAC,OAAO,OAAjB,CAAkB;QAChC,IAAI,MAAM,EAAE;YACV,OAAO,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;SAC1C;IACH,CAAC;IAEM,iCAAa,GAApB;QACE,IAAM,OAAO,GAAQ,IAAI,CAAC,OAAO,CAAC;QAClC,IAAI,QAAQ,CAAC,OAAO,EAAE,YAAY,CAAC,EAAE;YACnC,OAAO,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;SAC3C;IACH,CAAC;IAEM,6BAAS,GAAhB;QACE,IAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC;QACxC,IAAM,MAAM,GAAG,EAAE,CAAC;QAClB,sBAAsB;QACtB,IAAI,CAAC,UAAU,EAAE,UAAC,IAAI;YACZ,IAAA,IAAI,GAAK,IAAI,KAAT,CAAU;YACtB,MAAM,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QAClC,CAAC,CAAC,CAAC;QACH,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,SAAS;IACF,2BAAO,GAAd;QACE,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,iBAAM,OAAO,WAAE,CAAC;IAClB,CAAC;IAED,YAAY;IACL,gCAAY,GAAnB,UAAoB,GAAe;QACjC,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,GAAG,CAAC,OAAO,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,KAAK,MAAM,EAAE;YACzF,GAAG,CAAC,OAAO,GAAG,MAAM,CAAC;SACtB;QACD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;QACpC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACpC,CAAC;IAEM,8BAAU,GAAjB,UAAkB,IAAgB;QAChC,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,kBAAkB,CAAC,CAAC;QACpD,IAAM,aAAa,GAAG,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACjD,IAAI,CAAC,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QAE3C,cAAc;QACd,IAAI,aAAa,EAAE;YACjB,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,OAAO,IAAI,MAAM,CAAC;YAC7D,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YAClC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;SACpB;aAAM;YACL,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;SACzC;QAED,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,iBAAiB,CAAC,CAAC;IACrD,CAAC;IAED,+BAA+B;IACxB,2BAAO,GAAd;QACE,OAAO,IAAI,CAAC,IAAI,CAAC;IACnB,CAAC;IAED;;OAEG;IACI,6BAAS,GAAhB;QACE,OAAO,IAAI,CAAC,MAAM,CAAC;IACrB,CAAC;IAED,gBAAgB;IACT,4BAAQ,GAAf;QACE,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;YACf,OAAO,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;SAC/D;QACD,OAAO,IAAI,CAAC,KAAK,CAAC;IACpB,CAAC;IAEM,sCAAkB,GAAzB;QACE,OAAO,IAAI,CAAC,eAAe,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC5D,CAAC;IAED,kBAAkB;IACX,gCAAY,GAAnB;QACE,OAAO,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;IACpE,CAAC;IAEM,mCAAe,GAAtB;QACE,OAAO,IAAI,CAAC,YAAY,CAAC;IAC3B,CAAC;IAED,sBAAsB;IACf,oCAAgB,GAAvB,UAAwB,YAAY,EAAE,GAAG;QACvC,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,YAAY,EAAE,GAAG,CAAC,CAAC;IAC3D,CAAC;IAED,eAAe;IACR,6BAAS,GAAhB,UAAiB,SAAS,EAAE,KAAK;QAC/B,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,SAAS,WAAA,EAAE,KAAK,OAAA,EAAE,CAAC,CAAC;IACtE,CAAC;IAEM,+BAAW,GAAlB,UAAmB,SAAS,EAAE,KAAK;QACjC,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,UAAU,EAAE,SAAS,WAAA,EAAE,KAAK,OAAA,EAAE,CAAC,CAAC;IACxE,CAAC;IAEM,8BAAU,GAAjB,UAAkB,SAAS,EAAE,KAAK;QAChC,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS,WAAA,EAAE,KAAK,OAAA,EAAE,CAAC,CAAC;IACvE,CAAC;IAEM,8BAAU,GAAjB,UAAkB,SAAS,EAAE,KAAK;QAChC,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS,WAAA,EAAE,KAAK,OAAA,EAAE,CAAC,CAAC;IACvE,CAAC;IAED,oBAAoB;IACb,2BAAO,GAAd,UAAe,KAAc,EAAE,GAAY;QACzC,OAAO,IAAI,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,KAAK,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,CAAC;IACvE,CAAC;IAES,+BAAW,GAArB,UAAsB,IAAiB;QACrC,OAAO,IAAI,CAAC;IACd,CAAC;IAIS,yBAAK,GAAf;QACE,mBAAmB;QACnB,0GAA0G;QAC1G,6CAA6C;QAC7C,IAAM,UAAU,GAAG,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,UAAC,WAAgB;YAChE,IAAM,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC;YAC9B,OAAO,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,MAAA,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;QAC9B,CAAC,CAAC,CAAC;QACH,IAAM,MAAM,GAAG,OAAO,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,IAAI,EAAE,EAAE,UAAU,CAAC,CAAC;QAEpF,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;IACnC,CAAC;IAES,wBAAI,GAAd;QACE,IAAM,YAAY,GAAG,YAAY,CAAC,MAAM,EAAE;YACxC,IAAI,EAAE,IAAI;YACV,GAAG,EAAE,GAAG;SACT,CAAC,CAAC;QACH,IAAM,YAAY,GAAG,YAAY,CAAC,MAAM,EAAE;YACxC,IAAI,EAAE,IAAI;YACV,GAAG,EAAE,GAAG;SACT,CAAC,CAAC;QACH,IAAM,UAAU,GAAG,EAAE,CAAC;QACtB,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,YAAY,CAAC;QAC/C,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,YAAY,CAAC;QAC/C,sBAAsB;QACtB,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC;IACrC,CAAC;IAES,2BAAO,GAAjB;;QACE,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,KAAK,KAAK,EAAE;YAC1C,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;YACjC,OAAO;SACR;QACD,IAAM,cAAc,GAAG,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC;QACpD,UAAI,cAAc,CAAC,MAAM,0CAAE,SAAS,EAAE;YACpC,cAAc,CAAC,SAAS,GAAG,cAAc,CAAC,MAAM,CAAC,SAAS,CAAC;SAC5D;QACD,UAAI,cAAc,CAAC,MAAM,0CAAE,aAAa,EAAE;YACxC,cAAc,CAAC,aAAa,GAAG,cAAc,CAAC,MAAM,CAAC,aAAa,CAAC;SACpE;QACD,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,OAAO,CAAC,EAAE,EAAE,cAAc,CAAC,CAAC,CAAC;QAEvD,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;IACrE,CAAC;IAEO,0CAAsB,GAA9B;QACE,IAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAChD,SAAS,CAAC,SAAS,GAAG,YAAY,CAAC;QACnC,OAAO,SAAS,CAAC;IACnB,CAAC;IAES,iCAAa,GAAvB;QACE,IAAM,gBAAgB,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC;QACrD,IAAI,SAAS,CAAC;QACd,IAAI,gBAAgB,CAAC,SAAS,EAAE;YAC9B,SAAS,GAAG,QAAQ,CAAC,gBAAgB,CAAC,SAAS,CAAC;gBAC9C,CAAC,CAAC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,SAAS,CAAC;gBACrD,CAAC,CAAC,gBAAgB,CAAC,SAAS,CAAC;SAChC;QACD,IAAI,CAAC,SAAS,EAAE;YACd,SAAS,GAAG,IAAI,CAAC,sBAAsB,EAAE,CAAC;SAC3C;QACD,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE,UAAC,EAAuB;YACnD,IAAI,gBAAgB,aAAhB,gBAAgB,uBAAhB,gBAAgB,CAAE,QAAQ,EAAE;gBAC9B,gBAAgB,CAAC,QAAQ,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;aAC1C;QACH,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;QACxB,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,gBAAgB,EAAE,UAAC,EAAuB;YACrD,gBAAgB,CAAC,QAAQ,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;QAC3C,CAAC,CAAC,CAAC;IACL,CAAC;IAES,qCAAiB,GAA3B,UAA4B,QAAgB;QAC1C,IAAM,YAAY,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACzC,iCAAiC;QACjC,IAAI,YAAY,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,IAAI,YAAY,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;YAC3E,OAAO,YAAY,CAAC,CAAC,CAAC,CAAC;SACxB;QACD,OAAO,QAAQ,CAAC;IAClB,CAAC;IAES,0BAAM,GAAhB;;QACE,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,KAAK,KAAK,EAAE;YACzC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;YACjC,OAAO;SACR;QACD,IAAM,OAAO,GAAG,OAAO,CAAC,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QACpE,IAAM,YAAY,GAAG;YACnB,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;YAC1D,OAAO,EAAE,GAAG,CAAC,OAAO,EAAE,SAAS,CAAC;YAChC,OAAO,EAAE,GAAG,CAAC,OAAO,EAAE,SAAS,CAAC;YAChC,QAAQ,EAAE,GAAG,CAAC,OAAO,EAAE,UAAU,CAAC;YAClC,MAAM,EAAE,GAAG,CAAC,OAAO,EAAE,QAAQ,CAAC;YAC9B,KAAK,EAAE,OAAA,OAAO,CAAC,KAAK,0CAAE,OAAO,EAAC,CAAC,CAAC,GAAG,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI;YAC5D,QAAQ,EAAE,GAAG,CAAC,OAAO,EAAE,MAAM,CAAC;SAC/B,CAAC;QAEF,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,YAAY,CAAC,CAAC;IAC1C,CAAC;IAES,8BAAU,GAApB;QAAA,iBAYC;QAXC,IAAM,MAAM,GAAG,EAAE,CAAC;QAClB,IAAI,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,IAAI,KAAK,WAAW,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;YACzE,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,UAAC,IAAI;gBAChC,IAAM,SAAS,GAAG,YAAY,CAAC,WAAW,EAAE;oBAC1C,IAAI,EAAE,KAAI;oBACV,GAAG,EAAE,IAAI;iBACV,CAAC,CAAC;gBACH,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACzB,CAAC,CAAC,CAAC;SACJ;QACD,IAAI,CAAC,SAAS,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;IACxC,CAAC;IAKS,+BAAW,GAArB;QAAA,iBAeC;QAdS,IAAA,KAAsB,IAAI,CAAC,OAAO,aAAjB,EAAjB,YAAY,mBAAG,EAAE,KAAA,CAAkB;QAC3C,IAAI,CAAC,YAAY,EAAE,UAAC,WAAW;YACrB,IAAA,IAAI,GAAK,WAAW,KAAhB,CAAiB;YAC7B,IAAI,IAAI,KAAK,QAAQ,IAAI,IAAI,KAAK,WAAW,EAAE;gBAC7C,IAAM,UAAU,GAAG;oBACjB,KAAK,EAAE;wBACL,QAAQ,EAAE,IAAI;wBACd,UAAU,EAAE,KAAK;qBAClB;iBACF,CAAC;gBACF,KAAI,CAAC,OAAO,CAAC,KAAK,GAAG,OAAO,CAAC,EAAE,EAAE,KAAI,CAAC,OAAO,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;aAClE;YACD,KAAI,CAAC,SAAS,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC;IACL,CAAC;IAES,6BAAS,GAAnB;QACE,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,KAAK,KAAK,EAAE;YACpC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;SAClC;IACH,CAAC;IAES,qCAAiB,GAA3B;QAAA,iBA4BC;QA3BC,IAAI,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAEhD,6BAA6B;QAC7B,IAAM,WAAW,GAAG,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,WAAW,CAAC;QACnD,IAAM,SAAS,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC9G,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,SAAS,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;QAEpC,IAAA,KAAsB,IAAI,CAAC,OAAO,aAAjB,EAAjB,YAAY,mBAAG,EAAE,KAAA,CAAkB;QAC3C,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAC,IAAI;gBAC7B,IAAI,CAAC,OAAO,EAAE,CAAC;YACjB,CAAC,CAAC,CAAC;SACJ;QACD,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;QACvB,YAAY,CAAC,OAAO,CAAC,UAAC,WAAW;YAC/B,IAAM,IAAI,GAAgC,eAAe,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,EAAE,KAAI,CAAC,IAAI,CAAC,CAAC;YACtG,IAAI,IAAI,EAAE;gBACR,IAAM,IAAI,GAAoB,IAAI,IAAI,CACpC,EAAE,IAAI,EAAE,KAAI,CAAC,IAAI,EAAE,EACnB,KAAI,EACJ,IAAI,CAAC,mBAAmB,CAAC,KAAK,EAAE,WAAW,CAAC,GAAG,CAAC,EAChD,WAAW,CAAC,GAAG,CAChB,CAAC;gBACF,IAAI,CAAC,MAAM,EAAE,CAAC;gBACd,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aAC9B;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,yBAAyB;IACf,6BAAS,GAAnB,UAA8C,GAAM,EAAE,MAA6B;QACjF,IAAI,GAAG,KAAK,UAAU,EAAE;YACtB,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,MAA8B,CAAC,CAAC;YAC5D,OAAO;SACR;QACD,IAAI,GAAG,KAAK,aAAa,EAAE;YACzB,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,MAAa,CAAC,CAAC;YAC7C,OAAO;SACR;QACD,IAAI,MAAM,KAAK,KAAK,EAAE;YACpB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;YACzB,OAAO;SACR;QACD,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC,CAAC;IACnC,CAAC;IAES,+BAAW,GAArB,UAAsB,WAAY;QAAlC,iBAaC;QAZS,IAAA,OAAO,GAAK,IAAI,QAAT,CAAU;QACzB,IAAI,OAAO,CAAC,MAAM,EAAE;YAClB,iBAAM,WAAW,YAAC,OAAO,CAAC,MAAM,CAAC,CAAC;YAClC,IAAM,UAAQ,GAAG,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC;YACjE,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,UAAC,CAAC,EAAE,CAAC;gBACxB,IAAI,UAAU,CAAC,CAAC,CAAC,EAAE;oBACjB,IAAM,SAAS,GAAG,UAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;oBACnC,IAAM,OAAO,GAAG,CAAC,CAAC;oBAClB,OAAO,CAAC,KAAI,EAAE,SAAS,EAAE,OAAO,CAAC,CAAC;iBACnC;YACH,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAES,6BAAS,GAAnB;QACE,IAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC;QAC3B,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC;QAC7B,IAAI,IAAI,CAAC,KAAK,EAAE;YACd,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;YACrB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;SACnB;QAED,IAAI,YAAY,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE;YAC7B,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;YACzB,IAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;YAChC,IAAM,KAAK,GAAG,IAAI,eAAe,CAAC;gBAChC,UAAU,EAAE,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;gBAC/C,WAAW,EAAE,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;gBAChD,SAAS,EAAE,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;gBAC9C,IAAI,EAAE,KAAK,CAAC,KAAK,CAAC,IAAI;gBACtB,KAAK,EAAE,GAAG,CAAC,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC;gBAC1C,YAAY,EAAE,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;gBACrE,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAS;gBAC3C,KAAK,OAAA;gBACL,KAAK,EAAE,YAAY,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC9C,IAAI,EAAE,IAAI;gBACV,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,OAAO;gBAC5B,IAAI,EAAE,OAAO;aACd,CAAC,CAAC;YACH,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;SACxD;IACH,CAAC;IAES,mCAAe,GAAzB;QACE,IAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC;QAC3B,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC;QAC7B,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;YAC3B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;SACzB;QAED,IAAI,YAAY,CAAC,KAAK,CAAC,WAAW,CAAC,EAAE;YACnC,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;YACzB,IAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;YAChC,IAAI,SAAS,GAAG,CAAC,CAAC;YAElB,IAAI,IAAI,CAAC,KAAK,EAAE;gBACd,IAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;gBACvC,SAAS,IAAI,SAAS,CAAC,IAAI,GAAG,SAAS,CAAC,MAAM,CAAC;gBAC/C,SAAS,IAAI,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;aAC3C;iBAAM;gBACL,6BAA6B;gBAC7B,SAAS,IAAI,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;aAClD;YAED,IAAM,WAAW,GAAG,IAAI,eAAe,CAAC;gBACtC,UAAU,EAAE,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC;gBACrD,SAAS,WAAA;gBACT,WAAW,EAAE,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;gBAChD,IAAI,EAAE,KAAK,CAAC,WAAW,CAAC,IAAI;gBAC5B,KAAK,EAAE,GAAG,CAAC,KAAK,CAAC,WAAW,EAAE,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC;gBACtD,YAAY,EAAE,KAAK,GAAG,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC;gBACjF,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAS;gBAC3C,KAAK,OAAA;gBACL,KAAK,EAAE,CAAC;gBACR,IAAI,EAAE,IAAI;gBACV,OAAO,EAAE,KAAK,CAAC,WAAW,CAAC,OAAO;gBAClC,IAAI,EAAE,aAAa;aACpB,CAAC,CAAC;YACH,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;YAC/B,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;SAC9D;IACH,CAAC;IAES,iCAAa,GAAvB,UAAwB,QAAkB,EAAE,KAAY;QACtD,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,UAAC,IAAI;YACrB,IAAI,CAAC,OAAO,EAAE,CAAC;QACjB,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QACjB,IAAM,MAAM,GAAyB;YACnC,KAAK,EAAE,IAAI;YACX,SAAS,EAAE,QAAQ,CAAC,eAAe;YACnC,QAAQ,UAAA;YACR,KAAK,OAAA;SACN,CAAC;QACF,IAAM,IAAI,GAAG,iBAAiB,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAC3C,IAAI,IAAI,EAAE;YACR,IAAM,OAAK,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC;YAC/B,OAAK,CAAC,IAAI,EAAE,CAAC;YACb,OAAK,CAAC,MAAM,EAAE,CAAC;YACf,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAK,CAAC,CAAC;SACzB;IACH,CAAC;IAED,4CAA4C;IACpC,6BAAS,GAAjB;QACE,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC7B,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,kBAAkB;QAClB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACxB,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;SACrB;IACH,CAAC;IAEO,yCAAqB,GAA7B;QACE,qBAAqB;QACrB,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAC,IAAI;gBAC7B,IAAI,CAAC,OAAO,EAAE,CAAC;YACjB,CAAC,CAAC,CAAC;SACJ;QACD,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;IACzB,CAAC;IAEO,mCAAe,GAAvB;QACE,uBAAuB;QACvB,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,UAAC,KAAgB;YACjC,KAAK,CAAC,OAAO,EAAE,CAAC;QAClB,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;IACnB,CAAC;IAES,gCAAY,GAAtB;QAAA,iBAuCC;QAtCC,yCAAyC;QACjC,IAAA,KAAsB,IAAI,CAAC,OAAO,aAAjB,EAAjB,YAAY,mBAAG,EAAE,KAAA,CAAkB;QAC3C,oCAAoC;QACpC,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,mBAAmB,EAAE,CAAC;QAC/D,YAAY,CAAC,OAAO,CAAC,UAAC,WAAW;YAC/B,IAAM,IAAI,GAAgC,eAAe,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,EAAE,KAAI,CAAC,IAAI,CAAC,CAAC;YACtG,IAAM,KAAK,GAAqB,IAAI,IAAI,IAAI,CAAC,mBAAmB,CAAC,SAAS,EAAE,WAAW,CAAC,GAAG,CAAC,CAAC;YAC7F,IAAI,QAAQ,GAAG,EAAE,CAAC;YAClB,IAAI,KAAK,EAAE;gBACT,mBAAmB;gBACnB,IAAI,KAAK,CAAC,IAAI,KAAK,SAAS,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,EAAE;oBAChE,6BAA6B;oBAC7B,QAAQ,GAAG,QAAQ,CAAC;iBACrB;qBAAM,IAAI,KAAK,CAAC,IAAI,KAAK,SAAS,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,EAAE;oBACvE,4BAA4B;oBAC5B,QAAQ,GAAG,OAAO,CAAC;iBACpB;qBAAM,IAAI,KAAK,CAAC,IAAI,KAAK,SAAS,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,EAAE;oBACvE,4BAA4B;oBAC5B,QAAQ,GAAG,MAAM,CAAC;iBACnB;qBAAM,IAAI,KAAK,CAAC,IAAI,KAAK,SAAS,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,EAAE;oBACvE,6BAA6B;oBAC7B,QAAQ,GAAG,KAAK,CAAC;iBAClB;gBACD,KAAI,CAAC,iBAAiB,CAAC,eAAe,CACpC;oBACE,WAAW,EAAE,WAAW,CAAC,IAAI;oBAC7B,IAAI,EAAE,WAAW,CAAC,IAAI;oBACtB,OAAO,EAAE;wBACP,OAAO,KAAK,CAAC;oBACf,CAAC;oBACD,QAAQ,UAAA;iBACT,EACD,OAAO,CACR,CAAC;aACH;QACH,CAAC,CAAC,CAAC;QACH,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,mBAAmB,EAAE,CAAC;QAC/D,OAAO,SAAS,CAAC;IACnB,CAAC;IAES,iCAAa,GAAvB;QACE,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,KAAmB,CAAC;QACtD,IACE,MAAM,CAAC,YAAY,EAAE,KAAK,CAAC;YAC3B,MAAM,CAAC,YAAY,EAAE,KAAK,CAAC;YAC3B,MAAM,CAAC,YAAY,EAAE,UAAU,CAAC;YAChC,MAAM,CAAC,YAAY,EAAE,UAAU,CAAC,EAChC;YACA,OAAO,IAAI,CAAC;SACb;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAEO,qCAAiB,GAAzB,UAA0B,SAAS;QAC3B,IAAA,KAA0B,IAAI,EAA5B,CAAC,OAAA,EAAE,CAAC,OAAA,EAAE,KAAK,WAAA,EAAE,MAAM,YAAS,CAAC;QACrC,IAAM,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAC1B,GAAG,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;QACvB,KAAK,CAAC,CAAC,GAAG,SAAS,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC;QACvC,KAAK,CAAC,CAAC,GAAG,SAAS,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC;QACxC,GAAG,CAAC,CAAC,GAAG,SAAS,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC;QACrC,GAAG,CAAC,CAAC,GAAG,SAAS,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC;QAEtC,OAAO;YACL,KAAK,OAAA;YACL,GAAG,KAAA;SACJ,CAAC;IACJ,CAAC;IACH,gBAAC;AAAD,CAAC,AA5vBD,CAA6F,KAAK,GA4vBjG","sourcesContent":["import {\n  deepMix,\n  isEmpty,\n  mapValues,\n  get,\n  each,\n  assign,\n  isFunction,\n  mix,\n  map,\n  flatten,\n  reduce,\n  findIndex,\n  isString,\n  contains,\n  hasKey,\n} from '@antv/util';\nimport { View, Geometry, VIEW_LIFE_CIRCLE } from '../dependents';\nimport TextDescription from '../components/description';\nimport BaseLabel, { LabelComponentConfig, getLabelComponent } from '../components/label/base';\nimport { getComponent } from '../components/factory';\nimport Interaction from '../interaction/core';\nimport BaseInteraction, { InteractionCtor } from '../interaction/index';\nimport {\n  IValueAxis,\n  Axis,\n  IDescription,\n  IInteractions,\n  ITitle,\n  Label,\n  Legend,\n  StateConfig,\n  Tooltip,\n  DataItem,\n  Animation,\n  Meta,\n  GuideLineConfig,\n  CustomTooltipConfig,\n} from '../interface/config';\nimport { G2Config } from '../interface/config';\nimport { EVENT_MAP, onEvent } from '../util/event';\nimport PaddingController from './controller/padding';\nimport StateController from './controller/state';\nimport ThemeController from './controller/theme';\nimport Layer, { LayerConfig } from './layer';\nimport { isTextUsable } from '../util/common';\nimport { LooseMap } from '../interface/types';\nimport BBox, { DIRECTION } from '../util/bbox';\nimport { VIEW_LAYER_LIFE_CYCLE } from './constants';\n\nexport interface ViewConfig {\n  renderer?: string;\n  data?: DataItem[];\n  meta?: LooseMap<Meta>;\n  padding?: number | number[] | string;\n  xField?: string;\n  yField?: string;\n  color?: string | string[] | {};\n  xAxis?: Axis;\n  yAxis?: Axis;\n  label?: Label | any;\n  tooltip?: Tooltip;\n  legend?: Legend;\n  animation?: Animation | boolean;\n  theme?: LooseMap | string;\n  responsiveTheme?: {} | string;\n  interactions?: IInteractions[];\n  responsive?: boolean;\n  title?: ITitle;\n  description?: IDescription;\n  guideLine?: GuideLineConfig[];\n  events?: {\n    [k: string]: ((...args: any[]) => any) | boolean;\n  };\n  defaultState?: {\n    active?: StateConfig;\n    inActive?: StateConfig;\n    selected?: StateConfig;\n    disabled?: StateConfig;\n  };\n  name?: string;\n}\n\nexport interface ViewLayerConfig extends ViewConfig, LayerConfig {}\n\nexport default abstract class ViewLayer<T extends ViewLayerConfig = ViewLayerConfig> extends Layer<T> {\n  public static getDefaultOptions(): Partial<ViewConfig> {\n    return {\n      renderer: 'canvas',\n      title: {\n        visible: false,\n        alignTo: 'left',\n        text: '',\n      },\n      description: {\n        visible: false,\n        text: '',\n        alignTo: 'left',\n      },\n      padding: 'auto',\n      legend: {\n        visible: true,\n        position: 'bottom-center',\n      },\n      tooltip: {\n        visible: true,\n        shared: true,\n        showCrosshairs: true,\n        crosshairs: {\n          type: 'x',\n        },\n        offset: 20,\n      },\n      xAxis: {\n        visible: true,\n        grid: {\n          visible: false,\n        },\n        line: {\n          visible: true,\n        },\n        tickLine: {\n          visible: true,\n        },\n        label: {\n          visible: true,\n          autoRotate: true,\n          autoHide: true,\n        },\n        title: {\n          visible: false,\n          spacing: 12,\n        },\n      },\n      yAxis: {\n        visible: true,\n        grid: {\n          visible: true,\n        },\n        line: {\n          visible: false,\n        },\n        tickLine: {\n          visible: false,\n        },\n        label: {\n          visible: true,\n          autoHide: true,\n          autoRotate: false,\n        },\n        title: {\n          autoRotate: true,\n          visible: false,\n          spacing: 12,\n        },\n      },\n      label: {\n        visible: false,\n      },\n      interactions: [{ type: 'tooltip' }, { type: 'legend-active' }, { type: 'legend-filter' }],\n      animation: true,\n    };\n  }\n  public type: string;\n  public view: View;\n  public theme: any;\n  public initialOptions: T;\n  public title: TextDescription;\n  public description: TextDescription;\n  public viewRange: BBox;\n  protected paddingController: PaddingController;\n  protected stateController: StateController;\n  protected themeController: ThemeController;\n  public config: G2Config;\n  protected interactions: Interaction[] = [];\n  protected labels: BaseLabel[] = [];\n\n  constructor(props: T) {\n    super(props);\n    this.options = this.getOptions(props);\n    this.initialOptions = deepMix({}, this.options);\n    this.paddingController = new PaddingController({\n      plot: this,\n    });\n    this.stateController = new StateController({\n      plot: this,\n    });\n    this.themeController = new ThemeController();\n  }\n\n  public getOptions(props: Partial<T>): T {\n    const curOptions = this.options || {};\n    const options = super.getOptions(props);\n    // @ts-ignore\n    const defaultOptions = this.constructor.getDefaultOptions(props);\n    // interactions 需要合并去重下，如果有更新 interactions，需要去掉当前的 interactions 配置\n    const interactions = reduce(\n      flatten(\n        map([options, defaultOptions, hasKey(props, 'interactions') ? props : curOptions], (src) =>\n          get(src, 'interactions', [])\n        )\n      ),\n      (result, cur) => {\n        const idx = findIndex(result, (item) => item.type === cur.type);\n        if (idx >= 0) {\n          result.splice(idx, 1);\n        }\n        return [...result, cur];\n      },\n      []\n    );\n    return deepMix({}, options, defaultOptions, curOptions, props, { interactions });\n  }\n\n  public beforeInit() {\n    this.emit(VIEW_LAYER_LIFE_CYCLE.BEFORE_INIT);\n    super.beforeInit();\n  }\n\n  public init() {\n    super.init();\n    this.theme = this.themeController.getTheme(this.options, this.type);\n    this.config = {\n      data: this.processData(this.options.data),\n      scales: {},\n      legends: {},\n      tooltip: {\n        showTitle: true,\n      },\n      axes: {},\n      coordinate: { type: 'cartesian' },\n      geometries: [],\n      annotations: [],\n      interactions: [],\n      theme: this.theme,\n      panelRange: {},\n      animate: {} as any,\n      views: [],\n    };\n\n    this.paddingController.clear();\n\n    this.drawTitle();\n    this.drawDescription();\n    // 有些interaction要调整配置项，所以顺序提前\n    this.interaction();\n    this.coord();\n    this.scale();\n    this.axis();\n    this.tooltip();\n    this.legend();\n    this.addGeometry();\n    this.annotation();\n    this.animation();\n\n    this.viewRange = this.getViewRange();\n    const region = this.viewRangeToRegion(this.viewRange);\n    this.view = new View({\n      parent: null,\n      canvas: this.canvas,\n      backgroundGroup: this.container.addGroup(),\n      middleGroup: this.container.addGroup(),\n      foregroundGroup: this.container.addGroup(),\n      padding: this.paddingController.getPadding(),\n      theme: this.theme,\n      options: this.config,\n      limitInPlot: this.isLimitInPlot(),\n      region,\n    });\n    this.applyInteractions();\n    this.view.on(VIEW_LIFE_CIRCLE.AFTER_RENDER, () => {\n      this.afterRender();\n    });\n  }\n\n  public afterInit() {\n    super.afterInit();\n    if (!this.view || this.view.destroyed) {\n      return;\n    }\n    if (this.options.padding !== 'auto') {\n      this.parseEvents();\n    }\n    this.emit(VIEW_LAYER_LIFE_CYCLE.AFTER_INIT);\n  }\n\n  public afterRender() {\n    if (!this.view || this.view.destroyed) {\n      return;\n    }\n    const { options } = this;\n    const padding = options.padding ? options.padding : this.config.theme.padding;\n    /** defaultState */\n    if (options.defaultState && padding !== 'auto') {\n      this.stateController.defaultStates(options.defaultState);\n    }\n    /** autopadding */\n    if (padding === 'auto') {\n      this.paddingController.processAutoPadding();\n    }\n    if (options.tooltip?.custom?.onChange && options.padding !== 'auto') {\n      this.customTooltip();\n    }\n  }\n\n  /** 完整生命周期渲染 */\n  public render(): void {\n    this.emit(VIEW_LAYER_LIFE_CYCLE.BEFORE_RENDER);\n    super.render();\n    const { data } = this.options;\n    if (!isEmpty(data)) {\n      this.view.render();\n    }\n    this.emit(VIEW_LAYER_LIFE_CYCLE.AFTER_RENDER);\n  }\n\n  /** 画布重绘 */\n  public repaint(): void {\n    if (this.canvas) {\n      this.canvas.draw();\n    }\n  }\n\n  public getScaleByField(field: string) {\n    return this.view.getScaleByField(field);\n  }\n\n  public getXScale() {\n    const { xField } = this.options;\n    if (xField) {\n      return this.view.getScaleByField(xField);\n    }\n  }\n\n  public getYScale() {\n    const { yField } = this.options;\n    if (yField) {\n      return this.view.getScaleByField(yField);\n    }\n  }\n\n  public getColorScale() {\n    const options: any = this.options;\n    if (contains(options, 'colorField')) {\n      return this.view.getScaleByField(options);\n    }\n  }\n\n  public getShapes() {\n    const geometries = this.view.geometries;\n    const shapes = {};\n    // todo: geometry 类型转译\n    each(geometries, (geom) => {\n      const { type } = geom;\n      shapes[type] = geom.getShapes();\n    });\n    return shapes;\n  }\n\n  /** 销毁 */\n  public destroy(): void {\n    this.doDestroy();\n    super.destroy();\n  }\n\n  /** 更新配置项 */\n  public updateConfig(cfg: Partial<T>): void {\n    this.doDestroy();\n    if (!cfg.padding && this.initialOptions.padding && this.initialOptions.padding === 'auto') {\n      cfg.padding = 'auto';\n    }\n    this.options = this.getOptions(cfg);\n    this.processOptions(this.options);\n  }\n\n  public changeData(data: DataItem[]): void {\n    this.emit(VIEW_LAYER_LIFE_CYCLE.BEFORE_CHANGE_DATA);\n    const isEmptyBefore = isEmpty(this.options.data);\n    this.options.data = this.processData(data);\n\n    // 如果之前没有 data\n    if (isEmptyBefore) {\n      this.options.padding = this.initialOptions.padding || 'auto';\n      this.view.data(this.options.data);\n      this.view.render();\n    } else {\n      this.view.changeData(this.options.data);\n    }\n\n    this.emit(VIEW_LAYER_LIFE_CYCLE.AFTER_CHANGE_DATA);\n  }\n\n  // plot 不断销毁重建，需要一个api获取最新的plot\n  public getPlot() {\n    return this.view;\n  }\n\n  /**\n   * 获取已渲染的数据标签组件\n   */\n  public getLabels() {\n    return this.labels;\n  }\n\n  // 获取对应的G2 Theme\n  public getTheme() {\n    if (!this.theme) {\n      return this.themeController.getTheme(this.options, this.type);\n    }\n    return this.theme;\n  }\n\n  public getResponsiveTheme() {\n    return this.themeController.getResponsiveTheme(this.type);\n  }\n\n  // 获取对应的Plot Theme\n  public getPlotTheme() {\n    return this.themeController.getPlotTheme(this.options, this.type);\n  }\n\n  public getInteractions() {\n    return this.interactions;\n  }\n\n  // 绑定一个外部的stateManager\n  public bindStateManager(stateManager, cfg): void {\n    this.stateController.bindStateManager(stateManager, cfg);\n  }\n\n  // 响应状态量更新的快捷方法\n  public setActive(condition, style) {\n    this.stateController.setState({ type: 'active', condition, style });\n  }\n\n  public setSelected(condition, style) {\n    this.stateController.setState({ type: 'selected', condition, style });\n  }\n\n  public setDisable(condition, style) {\n    this.stateController.setState({ type: 'disable', condition, style });\n  }\n\n  public setDefault(condition, style) {\n    this.stateController.setState({ type: 'default', condition, style });\n  }\n\n  // 获取 ViewLayer 的数据项\n  public getData(start?: number, end?: number): object[] {\n    return this.processData((this.options.data || []).slice(start, end));\n  }\n\n  protected processData(data?: DataItem[]): DataItem[] | undefined {\n    return data;\n  }\n\n  protected abstract coord(): void;\n\n  protected scale(): void {\n    /** scale meta配置 */\n    // 1. this.config.scales中已有子图形在处理xAxis/yAxis是写入的xField/yField对应的scale信息，这里再检查用户设置的meta，将meta信息合并到默认的scale中\n    // 2. 同时xAxis/yAxis中的type优先级更高，覆盖meta中的type配置\n    const scaleTypes = mapValues(this.config.scales, (scaleConfig: any) => {\n      const type = scaleConfig.type;\n      return type ? { type } : {};\n    });\n    const scales = deepMix({}, this.config.scales, this.options.meta || {}, scaleTypes);\n\n    this.setConfig('scales', scales);\n  }\n\n  protected axis(): void {\n    const xAxis_parser = getComponent('axis', {\n      plot: this,\n      dim: 'x',\n    });\n    const yAxis_parser = getComponent('axis', {\n      plot: this,\n      dim: 'y',\n    });\n    const axesConfig = {};\n    axesConfig[this.options.xField] = xAxis_parser;\n    axesConfig[this.options.yField] = yAxis_parser;\n    /** 存储坐标轴配置项到config */\n    this.setConfig('axes', axesConfig);\n  }\n\n  protected tooltip(): void {\n    if (this.options.tooltip.visible === false) {\n      this.setConfig('tooltip', false);\n      return;\n    }\n    const tooltipOptions = get(this.options, 'tooltip');\n    if (tooltipOptions.custom?.container) {\n      tooltipOptions.container = tooltipOptions.custom.container;\n    }\n    if (tooltipOptions.custom?.customContent) {\n      tooltipOptions.customContent = tooltipOptions.custom.customContent;\n    }\n    this.setConfig('tooltip', deepMix({}, tooltipOptions));\n\n    deepMix(this.config.theme.tooltip, this.options.tooltip.domStyles);\n  }\n\n  private createTooltipContainer() {\n    const container = document.createElement('div');\n    container.className = 'g2-tooltip';\n    return container;\n  }\n\n  protected customTooltip() {\n    const customContentCfg = this.options.tooltip.custom;\n    let container;\n    if (customContentCfg.container) {\n      container = isString(customContentCfg.container)\n        ? document.getElementById(customContentCfg.container)\n        : customContentCfg.container;\n    }\n    if (!container) {\n      container = this.createTooltipContainer();\n    }\n    this.view.on('tooltip:show', (ev: CustomTooltipConfig) => {\n      if (customContentCfg?.onChange) {\n        customContentCfg.onChange(container, ev);\n      }\n    });\n    this.view.hideTooltip();\n    this.view.on('tooltip:change', (ev: CustomTooltipConfig) => {\n      customContentCfg.onChange(container, ev);\n    });\n  }\n\n  protected getLegendPosition(position: string): any {\n    const positionList = position.split('-');\n    // G2 4.0 兼容 XXX-center 到 XXX 的场景\n    if (positionList && positionList.length > 1 && positionList[1] === 'center') {\n      return positionList[0];\n    }\n    return position;\n  }\n\n  protected legend(): void {\n    if (this.options.legend.visible === false) {\n      this.setConfig('legends', false);\n      return;\n    }\n    const options = deepMix({}, this.theme.legend, this.options.legend);\n    const legendConfig = {\n      position: this.getLegendPosition(get(options, 'position')),\n      offsetX: get(options, 'offsetX'),\n      offsetY: get(options, 'offsetY'),\n      flipPage: get(options, 'flipPage'),\n      marker: get(options, 'marker'),\n      title: options.title?.visible ? get(options, 'title') : null,\n      itemName: get(options, 'text'),\n    };\n\n    this.setConfig('legends', legendConfig);\n  }\n\n  protected annotation() {\n    const config = [];\n    if (this.config.coordinate.type === 'cartesian' && this.options.guideLine) {\n      each(this.options.guideLine, (line) => {\n        const guideLine = getComponent('guideLine', {\n          plot: this,\n          cfg: line,\n        });\n        config.push(guideLine);\n      });\n    }\n    this.setConfig('annotations', config);\n  }\n\n  protected abstract addGeometry(): void;\n  protected abstract geometryParser(dim: string, type: string): string;\n\n  protected interaction() {\n    const { interactions = [] } = this.options;\n    each(interactions, (interaction) => {\n      const { type } = interaction;\n      if (type === 'slider' || type === 'scrollbar') {\n        const axisConfig = {\n          label: {\n            autoHide: true,\n            autoRotate: false,\n          },\n        };\n        this.options.xAxis = deepMix({}, this.options.xAxis, axisConfig);\n      }\n      this.setConfig('interaction', interaction);\n    });\n  }\n\n  protected animation() {\n    if (this.options.animation === false) {\n      this.setConfig('animate', false);\n    }\n  }\n\n  protected applyInteractions(): void {\n    let range = BBox.fromBBoxObject(this.layerBBox);\n\n    // 临时去掉 title/description 的占用\n    const titleOrDesc = this.title || this.description;\n    const extraBBox = new BBox(range.minX, range.minY, range.width, titleOrDesc ? titleOrDesc.getBBox().maxY : 0);\n    range = range.cut(extraBBox, DIRECTION.TOP);\n\n    const { interactions = [] } = this.options;\n    if (this.interactions) {\n      this.interactions.forEach((inst) => {\n        inst.destroy();\n      });\n    }\n    this.interactions = [];\n    interactions.forEach((interaction) => {\n      const Ctor: InteractionCtor | undefined = BaseInteraction.getInteraction(interaction.type, this.type);\n      if (Ctor) {\n        const inst: BaseInteraction = new Ctor(\n          { view: this.view },\n          this,\n          Ctor.getInteractionRange(range, interaction.cfg),\n          interaction.cfg\n        );\n        inst.render();\n        this.interactions.push(inst);\n      }\n    });\n  }\n\n  /** 设置G2 config，带有类型推导 */\n  protected setConfig<K extends keyof G2Config>(key: K, config: G2Config[K] | boolean): void {\n    if (key === 'geometry') {\n      this.config.geometries.push(config as G2Config['geometry']);\n      return;\n    }\n    if (key === 'interaction') {\n      this.config.interactions.push(config as any);\n      return;\n    }\n    if (config === false) {\n      this.config[key] = false;\n      return;\n    }\n    assign(this.config[key], config);\n  }\n\n  protected parseEvents(eventParser?): void {\n    const { options } = this;\n    if (options.events) {\n      super.parseEvents(options.events);\n      const eventmap = eventParser ? eventParser.EVENT_MAP : EVENT_MAP;\n      each(options.events, (e, k) => {\n        if (isFunction(e)) {\n          const eventName = eventmap[k] || k;\n          const handler = e;\n          onEvent(this, eventName, handler);\n        }\n      });\n    }\n  }\n\n  protected drawTitle(): void {\n    const props = this.options;\n    const range = this.layerBBox;\n    if (this.title) {\n      this.title.destroy();\n      this.title = null;\n    }\n\n    if (isTextUsable(props.title)) {\n      const width = this.width;\n      const theme = this.config.theme;\n      const title = new TextDescription({\n        leftMargin: range.minX + theme.title.padding[3],\n        rightMargin: range.maxX - theme.title.padding[1],\n        topMargin: range.minY + theme.title.padding[0],\n        text: props.title.text,\n        style: mix(theme.title, props.title.style),\n        wrapperWidth: width - theme.title.padding[3] - theme.title.padding[1],\n        container: this.container.addGroup() as any,\n        theme,\n        index: isTextUsable(props.description) ? 0 : 1,\n        plot: this,\n        alignTo: props.title.alignTo,\n        name: 'title',\n      });\n      this.title = title;\n      this.paddingController.registerPadding(title, 'outer');\n    }\n  }\n\n  protected drawDescription(): void {\n    const props = this.options;\n    const range = this.layerBBox;\n    if (this.description) {\n      this.description.destroy();\n      this.description = null;\n    }\n\n    if (isTextUsable(props.description)) {\n      const width = this.width;\n      const theme = this.config.theme;\n      let topMargin = 0;\n\n      if (this.title) {\n        const titleBBox = this.title.getBBox();\n        topMargin += titleBBox.minY + titleBBox.height;\n        topMargin += theme.description.padding[0];\n      } else {\n        // 无title的情况下使用title的上padding\n        topMargin += range.minY + theme.title.padding[0];\n      }\n\n      const description = new TextDescription({\n        leftMargin: range.minX + theme.description.padding[3],\n        topMargin,\n        rightMargin: range.maxX - theme.title.padding[1],\n        text: props.description.text,\n        style: mix(theme.description, props.description.style),\n        wrapperWidth: width - theme.description.padding[3] - theme.description.padding[1],\n        container: this.container.addGroup() as any,\n        theme,\n        index: 1,\n        plot: this,\n        alignTo: props.description.alignTo,\n        name: 'description',\n      });\n      this.description = description;\n      this.paddingController.registerPadding(description, 'outer');\n    }\n  }\n\n  protected doRenderLabel(geometry: Geometry, label: Label) {\n    each(this.labels, (item) => {\n      item.destroy();\n    });\n    this.labels = [];\n    const config: LabelComponentConfig = {\n      layer: this,\n      container: geometry.labelsContainer,\n      geometry,\n      label,\n    };\n    const Ctor = getLabelComponent(label.type);\n    if (Ctor) {\n      const label = new Ctor(config);\n      label.init();\n      label.render();\n      this.labels.push(label);\n    }\n  }\n\n  /** 抽取destroy和updateConfig共有代码为_destroy方法 */\n  private doDestroy() {\n    this.doDestroyInteractions();\n    this.doDestroyLabels();\n    /** 销毁g2.view实例 */\n    if (!this.view.destroyed) {\n      this.view.destroy();\n    }\n  }\n\n  private doDestroyInteractions() {\n    // 移除注册的 interactions\n    if (this.interactions) {\n      this.interactions.forEach((inst) => {\n        inst.destroy();\n      });\n    }\n    this.interactions = [];\n  }\n\n  private doDestroyLabels() {\n    // 移除各 geometry 的 label\n    each(this.labels, (label: BaseLabel) => {\n      label.destroy();\n    });\n    this.labels = [];\n  }\n\n  protected getViewRange() {\n    // 有 Range 的 Interaction 参与 ViewMargin 计算\n    const { interactions = [] } = this.options;\n    // const layerBBox = this.layerBBox;\n    const layerBBox = this.paddingController.processOuterPadding();\n    interactions.forEach((interaction) => {\n      const Ctor: InteractionCtor | undefined = BaseInteraction.getInteraction(interaction.type, this.type);\n      const range: BBox | undefined = Ctor && Ctor.getInteractionRange(layerBBox, interaction.cfg);\n      let position = '';\n      if (range) {\n        // 先只考虑 Range 靠边的情况\n        if (range.maxY === layerBBox.maxY && range.minY > layerBBox.minY) {\n          // margin[2] += range.height;\n          position = 'bottom';\n        } else if (range.maxX === layerBBox.maxX && range.minX > layerBBox.minX) {\n          // margin[1] += range.width;\n          position = 'right';\n        } else if (range.minX === layerBBox.minX && range.maxX > layerBBox.maxX) {\n          // margin[3] += range.width;\n          position = 'left';\n        } else if (range.minY === layerBBox.minY && range.maxY < layerBBox.maxY) {\n          // margin[0] += range.height;\n          position = 'top';\n        }\n        this.paddingController.registerPadding(\n          {\n            interaction: interaction.type,\n            name: interaction.type,\n            getBBox: () => {\n              return range;\n            },\n            position,\n          },\n          'outer'\n        );\n      }\n    });\n    const viewRange = this.paddingController.processOuterPadding();\n    return viewRange;\n  }\n\n  protected isLimitInPlot() {\n    const yAxisOptions = this.options.yAxis as IValueAxis;\n    if (\n      hasKey(yAxisOptions, 'max') ||\n      hasKey(yAxisOptions, 'min') ||\n      hasKey(yAxisOptions, 'maxLimit') ||\n      hasKey(yAxisOptions, 'minLimit')\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  private viewRangeToRegion(viewRange) {\n    const { x, y, width, height } = this;\n    const start = { x: 0, y: 0 },\n      end = { x: 1, y: 1 };\n    start.x = viewRange.minX / (x + width);\n    start.y = viewRange.minY / (y + height);\n    end.x = viewRange.maxX / (x + width);\n    end.y = viewRange.maxY / (y + height);\n\n    return {\n      start,\n      end,\n    };\n  }\n}\n"]}