{"version":3,"file":"legend.js","sourceRoot":"","sources":["../../../../src/plots/heatmap/component/legend.ts"],"names":[],"mappings":"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","sourcesContent":["import { each, isArray, deepMix } from '@antv/util';\nimport BBox from '../../../util/bbox';\nimport { View, IGroup, IShape } from '../../../dependents';\nimport { LegendPosition, GraphicStyle, TextStyle, LineStyle } from '../../../interface/config';\n\nconst LABEL_MARGIN = 4;\n\nexport interface MatrixLegendConfig {\n  visible?: boolean;\n  position?: LegendPosition;\n  width?: number;\n  height?: number;\n  text?: {\n    style?: TextStyle;\n    formatter?: () => string;\n  };\n  ticklineStyle?: LineStyle;\n  anchorStyle?: GraphicStyle;\n  triggerOn?: string;\n}\n\nexport interface IMatrixLegend extends MatrixLegendConfig {\n  view: View;\n  plot: any;\n}\n\nexport default class MatrixLegend {\n  public options: IMatrixLegend;\n  public container: IGroup;\n  public anchor: IShape;\n  public afterRender: boolean;\n  public destroyed: boolean = false;\n  protected view: View;\n  protected layout: string;\n  protected width: number;\n  protected height: number;\n  protected position: string;\n  protected x: number;\n  protected y: number;\n  protected dataSlides: any = {};\n  protected colorScale: any;\n  private interactiveEvents: any = {};\n\n  constructor(cfg: IMatrixLegend) {\n    const defaultOptions = this.getDefaultOptions();\n    this.options = deepMix({}, defaultOptions, cfg);\n    this.view = this.options.view;\n    this.afterRender = true;\n    this.init();\n  }\n\n  public init() {\n    this.layout = this.getLayout();\n    this.width = this.options.width ? this.options.width : this.getDefaultWidth();\n    this.height = this.options.height ? this.options.height : this.getDefaultHeight();\n    const plotContainer = this.options.plot.container;\n    if (this.container) {\n      this.container.remove();\n    }\n    this.container = plotContainer.addGroup();\n    this.view.on('beforerender', () => {\n      this.clear();\n      this.options.plot.canvas.draw();\n    });\n  }\n\n  public render() {\n    const scales = this.view.geometries[0].scales;\n    const colorField = this.options.plot.options.colorField;\n    this.colorScale = scales[colorField];\n    const { min, max } = this.colorScale;\n    const { color } = this.options.plot.options;\n    if (this.layout === 'horizontal') {\n      this.renderHorizontal(min, max, color);\n    } else {\n      this.renderVertical(min, max, color);\n    }\n    this.legendLayout();\n    this.addInteraction();\n  }\n\n  public hide() {\n    this.container.set('visible', false);\n    this.options.plot.canvas.draw();\n  }\n\n  public show() {\n    this.container.set('visible', true);\n    this.options.plot.canvas.draw();\n  }\n\n  public clear() {\n    if (this.container) {\n      this.container.clear();\n    }\n  }\n\n  public destroy() {\n    if (this.container) {\n      this.container.remove();\n    }\n    this.offEvent();\n    this.destroyed = true;\n  }\n\n  public getBBox() {\n    const origin_bbox = this.container.getBBox();\n    return new BBox(this.x, this.y, origin_bbox.width, origin_bbox.height);\n  }\n\n  protected renderVertical(min: number, max: number, colors: string[]) {\n    const valueStep = (max - min) / (colors.length - 1);\n    const colorStep = 1 / (colors.length - 1);\n    const tickStep = this.height / (colors.length - 1);\n    let gradientColor = 'l(90)';\n    each(colors, (c, index) => {\n      const stepNum = colorStep * index;\n      gradientColor += `${stepNum}:${c} `;\n    });\n    this.container.addShape('rect', {\n      attrs: {\n        x: 0,\n        y: 0,\n        width: this.width,\n        height: this.height,\n        fill: gradientColor,\n      },\n      name: 'legend',\n    });\n    // draw tick and label\n    each(colors, (c, index) => {\n      // tick\n      const step = tickStep * index;\n      this.container.addShape('path', {\n        attrs: {\n          path: [\n            ['M', 0, step],\n            ['L', this.width, step],\n          ],\n          ...this.options.ticklineStyle,\n        },\n      });\n      // value\n      const value = Math.round(valueStep * index);\n      this.container.addShape('text', {\n        attrs: {\n          text: value,\n          textAlign: 'left',\n          textBaseline: 'middle',\n          x: this.width + LABEL_MARGIN,\n          y: step,\n          ...this.options.text.style,\n        },\n        name: 'legend-label',\n      });\n    });\n    //anchor\n    const tri_width = 10;\n    const tri_height = 14;\n    const tri_path = [['M', -tri_width, -tri_height / 2], ['L', 0, 0], ['L', -tri_width, tri_height / 2], ['Z']];\n    this.anchor = this.container.addShape('path', {\n      attrs: {\n        path: tri_path,\n        ...this.options.anchorStyle,\n      },\n    });\n    this.anchor.set('visible', false);\n  }\n\n  protected renderHorizontal(min: number, max: number, colors: string[]) {\n    const valueStep = (max - min) / (colors.length - 1);\n    const colorStep = 1 / (colors.length - 1);\n    const tickStep = this.width / (colors.length - 1);\n    let gradientColor = 'l(0)';\n    each(colors, (c, index) => {\n      const stepNum = colorStep * index;\n      gradientColor += `${stepNum}:${c} `;\n    });\n    this.container.addShape('rect', {\n      attrs: {\n        x: 0,\n        y: 0,\n        width: this.width,\n        height: this.height,\n        fill: gradientColor,\n      },\n      name: 'legend',\n    });\n    // draw tick and label\n    each(colors, (c, index) => {\n      // tick\n      const step = tickStep * index;\n      this.container.addShape('path', {\n        attrs: {\n          path: [\n            ['M', step, 0],\n            ['L', step, this.height],\n          ],\n          ...this.options.ticklineStyle,\n        },\n        name: 'legend-label',\n      });\n      // value\n      const value = Math.round(valueStep * index);\n      this.container.addShape('text', {\n        attrs: {\n          text: value,\n          textAlign: 'center',\n          textBaseline: 'top',\n          x: step,\n          y: this.height + LABEL_MARGIN,\n          ...this.options.text.style,\n        },\n      });\n    });\n    //anchor\n    const tri_width = 14;\n    const tri_height = 10;\n    const tri_path = [['M', 0, 0], ['L', -tri_width / 2, -tri_height], ['L', tri_width / 2, -tri_height], ['Z']];\n    this.anchor = this.container.addShape('path', {\n      attrs: {\n        path: tri_path,\n        ...this.options.anchorStyle,\n      },\n    });\n    this.anchor.set('visible', false);\n  }\n\n  protected getLayout() {\n    const positions = this.options.position.split('-');\n    this.position = positions[0];\n    if (positions[0] === 'left' || positions[0] === 'right') {\n      return 'vertical';\n    }\n    return 'horizontal';\n  }\n\n  protected getDefaultWidth() {\n    if (this.layout === 'horizontal') {\n      const width = this.view.coordinateBBox.width;\n      return width;\n    }\n    return 10;\n  }\n\n  protected getDefaultHeight() {\n    if (this.layout === 'vertical') {\n      const height = this.view.coordinateBBox.height;\n      return height;\n    }\n    return 10;\n  }\n\n  protected legendLayout() {\n    const panelRange = this.view.coordinateBBox;\n    const { bleeding } = this.options.plot.getPlotTheme();\n    if (isArray(bleeding)) {\n      each(bleeding, (it, index) => {\n        if (typeof bleeding[index] === 'function') {\n          bleeding[index] = bleeding[index](this.options.plot.options);\n        }\n      });\n    }\n    const bbox = this.container.getBBox();\n    let x = 0;\n    let y = 0;\n    const positions = this.options.position.split('-');\n    const plotWidth = this.options.plot.width;\n    const plotHeight = this.options.plot.height;\n    // 先确定x\n    if (positions[0] === 'left') {\n      x = bleeding[3];\n    } else if (positions[0] === 'right') {\n      x = plotWidth - bleeding[1] - bbox.width;\n    } else if (positions[1] === 'center') {\n      // default\n      if (this.width === panelRange.width) {\n        x = panelRange.x;\n      } else {\n        x = (plotWidth - bbox.width) / 2;\n      }\n    } else if (positions[1] === 'left') {\n      x = bleeding[3];\n    } else if (positions[1] === 'right') {\n      x = this.options.plot.width - bleeding[1] - bbox.width;\n    }\n    // 再确定y\n    if (positions[0] === 'bottom') {\n      y = plotHeight - bleeding[2] - bbox.height;\n    } else if (positions[0] === 'top') {\n      y = this.getTopPosition(bleeding);\n    } else if (positions[1] === 'center') {\n      // default\n      if (this.height === panelRange.height) {\n        y = panelRange.y;\n      } else {\n        //用户自行设定\n        y = (plotHeight - bbox.height) / 2;\n      }\n    } else if (positions[1] === 'top') {\n      y = bleeding[0];\n    } else if (positions[1] === 'bottom') {\n      y = plotHeight - bleeding[2] - bbox.height;\n    }\n\n    this.x = x;\n    this.y = y;\n\n    this.container.translate(x, y);\n  }\n\n  protected getDefaultOptions() {\n    return {\n      text: {\n        style: {\n          fontSize: 12,\n          fill: 'rgba(0, 0, 0, 0.45)',\n        },\n      },\n      ticklineStyle: {\n        lineWidth: 1,\n        stroke: 'rgba(0, 0, 0, 0.8)',\n      },\n      anchorStyle: {\n        fill: 'rgba(0,0,0,0.5)',\n      },\n      triggerOn: 'mousemove',\n    };\n  }\n\n  protected addInteraction() {\n    let geomType;\n    if (this.options.plot.options.shapeType === 'rect') {\n      geomType = 'polygon';\n    } else {\n      geomType = 'point';\n    }\n\n    const eventName = `${geomType}:${this.options.triggerOn}`;\n    //const labelEventName = `label:${this.options.triggerOn}`;\n    const field = this.options.plot.options.colorField;\n    const { min, max } = this.colorScale;\n\n    const geomEventHandler = (ev) => {\n      const value = ev.data.data[field];\n      const ratio = (value - min) / (max - min);\n      this.moveAnchor(ratio);\n    };\n    this.view.on(eventName, geomEventHandler);\n    this.interactiveEvents[eventName] = {\n      target: this.view,\n      handler: geomEventHandler,\n    };\n\n    /*this.view.on(labelEventName, (ev) => {\n      const value = ev.data[field];\n      const ratio = (value - min) / (max - min);\n      this.moveAnchor(ratio);\n    });*/\n\n    const mouseleaveHandler = () => {\n      this.anchor.set('visible', false);\n    };\n    this.options.plot.canvas.on('mouseleave', mouseleaveHandler);\n    this.interactiveEvents.mouseleave = {\n      target: this.options.plot.canvas,\n      handler: mouseleaveHandler,\n    };\n  }\n\n  private moveAnchor(ratio: number) {\n    this.anchor.set('visible', true);\n    if (this.layout === 'vertical') {\n      const pos = this.height * ratio;\n      const ulMatrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n      ulMatrix[7] = pos;\n      this.anchor.stopAnimate();\n      this.anchor.animate(\n        {\n          matrix: ulMatrix,\n        },\n        400,\n        'easeLinear'\n      );\n    } else {\n      const pos = this.width * ratio;\n      const ulMatrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n      ulMatrix[6] = pos;\n      this.anchor.stopAnimate();\n      this.anchor.animate(\n        {\n          matrix: ulMatrix,\n        },\n        400,\n        'easeLinear'\n      );\n    }\n  }\n\n  private getTopPosition(bleeding) {\n    if (this.options.plot.description) {\n      const bbox = this.options.plot.description.getBBox();\n      return bbox.maxY + 10;\n    } else if (this.options.plot.title) {\n      const bbox = this.options.plot.title.getBBox();\n      return bbox.maxY + 10;\n    }\n    return bleeding[0];\n  }\n\n  private offEvent() {\n    each(this.interactiveEvents, (event, key) => {\n      const { target, handler } = event;\n      target.off(key, handler);\n    });\n  }\n}\n"]}