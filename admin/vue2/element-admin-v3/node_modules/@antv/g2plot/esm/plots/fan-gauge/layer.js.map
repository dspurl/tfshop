{"version":3,"file":"layer.js","sourceRoot":"","sources":["../../../src/plots/fan-gauge/layer.ts"],"names":[],"mappings":"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","sourcesContent":["import { deepMix, uniqueId } from '@antv/util';\nimport { registerPlotType } from '../../base/global';\nimport GaugeLayer from '../gauge/layer';\nimport { GaugeShape } from '../gauge/geometry/shape/gauge-shape';\nimport { GaugeViewConfig } from '../gauge/interface';\nimport { LayerConfig } from '../../base/layer';\n\nexport interface FanGaugeViewConfig extends GaugeViewConfig {}\n\nexport interface FanGaugeLayerConfig extends FanGaugeViewConfig, LayerConfig {}\n\nexport default class FanGaugeLayer<T extends FanGaugeLayerConfig = FanGaugeLayerConfig> extends GaugeLayer<T> {\n  public static getDefaultOptions() {\n    return deepMix({}, super.getDefaultOptions(), {\n      rangeColor: '#F6445A',\n      rangeSize: 70,\n      axis: {\n        visible: true,\n        offset: 5,\n        tickCount: 10,\n        subTickCount: 4,\n        tickLine: {\n          visible: true,\n          length: 3,\n          style: {\n            stroke: '#aaa',\n            lineWidth: 3,\n          },\n        },\n        label: {\n          visible: true,\n          style: {\n            fill: '#aaa',\n            fontSize: 16,\n            textAlign: 'center',\n            textBaseline: 'middle',\n          },\n        },\n      },\n    });\n  }\n\n  public type: string = 'fanGauge';\n\n  protected initG2Shape() {\n    this.gaugeShape = new GaugeShape(uniqueId());\n    this.gaugeShape.setOption(\n      this.type,\n      deepMix({}, this.options, {\n        radius: 1,\n        angle: 120,\n        textPosition: '125%',\n        bottomRatio: 3.5,\n      })\n    );\n    this.gaugeShape.render();\n  }\n\n  protected axis() {\n    const axesConfig: any = {\n      value: false,\n      1: false,\n    };\n    this.setConfig('axes', axesConfig);\n  }\n\n  protected annotation() {\n    const { statistic } = this.options;\n    const annotationConfigs = [];\n    // @ts-ignore\n    if (statistic && statistic.visible) {\n      const statistics = this.renderStatistic();\n      annotationConfigs.push(statistics);\n    }\n    const siderTexts = this.renderSideText();\n    const allAnnotations = annotationConfigs.concat(siderTexts);\n    this.setConfig('annotations', allAnnotations);\n  }\n\n  protected renderSideText() {\n    const { max, min, format, rangeSize, axis } = this.options;\n    const OFFSET_Y = 12;\n    return [min, max].map((value, index) => {\n      return {\n        type: 'text',\n        top: true,\n        position: ['50%', '50%'],\n        content: format(value),\n        style: deepMix({}, axis.label.style, {\n          textAlign: 'center',\n        }),\n        offsetX: !index ? -rangeSize : rangeSize,\n        offsetY: OFFSET_Y,\n      };\n    });\n  }\n}\n\nregisterPlotType('fanGauge', FanGaugeLayer);\n"]}