{"version":3,"file":"label.js","sourceRoot":"","sources":["../../../../src/plots/range-bar/component/label.ts"],"names":[],"mappings":"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","sourcesContent":["import { each, deepMix, clone, find } from '@antv/util';\nimport { View, IGroup, Geometry } from '../../../dependents';\nimport { rgb2arr } from '../../../util/color';\nimport BBox from '../../../util/bbox';\n\nconst DEFAULT_OFFSET = 8;\n\nfunction mappingColor(band, gray) {\n  let reflect;\n  each(band, (b) => {\n    const map = b;\n    if (gray >= map.from && gray < map.to) {\n      reflect = map.color;\n    }\n  });\n  return reflect;\n}\n\nexport interface RangeBarLabelConfig {\n  visible: boolean;\n  position?: 'outer' | 'inner';\n  formatter?: (...args: any[]) => string;\n  offsetX?: number;\n  offsetY?: number;\n  style?: any;\n  leftStyle?: any;\n  rightStyle?: any;\n  adjustColor?: boolean;\n  adjustPosition?: boolean;\n}\n\nexport interface IRangeBarLabel extends RangeBarLabelConfig {\n  view: View;\n  plot: any;\n}\n\nexport default class RangeBarLabel {\n  public options: RangeBarLabelConfig;\n  public destroyed: boolean = false;\n  private plot: any;\n  private view: View;\n  private coord: any;\n  private container: IGroup;\n\n  constructor(cfg: IRangeBarLabel) {\n    this.view = cfg.view;\n    this.plot = cfg.plot;\n    const defaultOptions = this.getDefaultOptions();\n    this.options = deepMix(defaultOptions, cfg, {});\n    if (!this.options.leftStyle) {\n      this.options.leftStyle = this.options.style;\n    }\n    if (!this.options.rightStyle) {\n      this.options.rightStyle = this.options.style;\n    }\n    this.init();\n  }\n\n  public init() {\n    this.container = this.getGeometry().labelsContainer;\n    this.view.on('beforerender', () => {\n      this.clear();\n      this.plot.canvas.draw();\n    });\n  }\n\n  public render() {\n    const { elements, coordinate } = this.getGeometry();\n    this.coord = coordinate;\n    each(elements, (ele) => {\n      const { shape } = ele;\n      const positions = this.getPosition(shape);\n      const values = this.getValue(shape);\n      const textAlign = this.getTextAlign();\n      const labels = [];\n      each(positions, (pos, i) => {\n        const style = i === 0 ? this.options.leftStyle : this.options.rightStyle;\n        const color = this.getTextColor(shape, i);\n        if (this.options.position === 'inner' && this.options.adjustColor && color !== 'black') {\n          style.stroke = null;\n        }\n        const formatter = this.options.formatter;\n        const content = formatter ? formatter(values[i]) : values[i];\n        const label = this.container.addShape('text', {\n          attrs: deepMix({}, style, {\n            x: pos.x,\n            y: pos.y,\n            text: content,\n            fill: color,\n            textAlign: textAlign[i],\n            textBaseline: 'middle',\n          }),\n          name: 'label',\n        });\n        labels.push(label);\n        this.doAnimation(label);\n      });\n      shape.set('labelShapes', labels);\n      this.adjustPosition(labels[0], labels[1], shape);\n    });\n    this.plot.canvas.draw();\n  }\n\n  public hide() {\n    this.container.set('visible', false);\n    this.plot.canvas.draw();\n  }\n\n  public show() {\n    this.container.set('visible', true);\n    this.plot.canvas.draw();\n  }\n\n  public clear() {\n    if (this.container) {\n      this.container.clear();\n    }\n  }\n\n  public destroy() {\n    if (this.container) {\n      this.container.remove();\n    }\n    this.destroyed = true;\n  }\n\n  public getBBox() {\n    return this.container.getBBox();\n  }\n\n  protected getShapeBbox(shape) {\n    const points = [];\n    each(shape.get('origin').points, (p) => {\n      points.push(this.coord.convertPoint(p));\n    });\n    const bbox = new BBox(\n      points[0].x,\n      points[1].y,\n      Math.abs(points[2].x - points[0].x),\n      Math.abs(points[0].y - points[1].y)\n    );\n    return bbox;\n  }\n\n  private getDefaultOptions() {\n    const { theme } = this.plot;\n    const labelStyle = theme.label.style;\n    return {\n      position: 'outer',\n      offsetX: DEFAULT_OFFSET,\n      offsetY: 0,\n      style: clone(labelStyle),\n      adjustColor: true,\n      adjustPosition: true,\n    };\n  }\n\n  private getPosition(shape) {\n    const bbox = this.getShapeBbox(shape);\n    const { minX, maxX, minY, height } = bbox;\n    const { offsetX, offsetY } = this.options;\n    const y = minY + height / 2 + offsetY;\n    let x1, x2;\n    if (this.options.position === 'outer') {\n      x1 = minX - offsetX;\n      x2 = maxX + offsetX;\n    } else {\n      x1 = minX + offsetX;\n      x2 = maxX - offsetX;\n    }\n    return [\n      { x: x1, y },\n      { x: x2, y },\n    ];\n  }\n\n  private getValue(shape) {\n    const { xField } = this.plot.options;\n    return shape.get('origin').data[xField];\n  }\n\n  private getTextAlign() {\n    if (this.options.position === 'outer') {\n      return ['right', 'left'];\n    } else {\n      return ['left', 'right'];\n    }\n  }\n\n  private getTextColor(shape, index) {\n    if (this.options.adjustColor && this.options.position === 'inner') {\n      const shapeColor = shape.attr('fill');\n      const shapeOpacity = shape.attr('opacity') ? shape.attr('opacity') : 1;\n      const rgb = rgb2arr(shapeColor);\n      const gray = Math.round(rgb[0] * 0.299 + rgb[1] * 0.587 + rgb[2] * 0.114) / shapeOpacity;\n      const colorBand = [\n        { from: 0, to: 85, color: 'white' },\n        { from: 85, to: 170, color: '#F6F6F6' },\n        { from: 170, to: 255, color: 'black' },\n      ];\n      const reflect = mappingColor(colorBand, gray);\n      return reflect;\n    }\n    const defaultColor = index === 0 ? this.options.leftStyle.fill : this.options.rightStyle.fill;\n    return defaultColor;\n  }\n\n  private doAnimation(label) {\n    if (this.plot.animation && this.plot.animation === false) {\n      return;\n    }\n    label.attr('fillOpacity', 0);\n    label.attr('strokeOpacity', 0);\n    label.stopAnimate();\n    label.animate(\n      {\n        fillOpacity: 1,\n        strokeOpacity: 1,\n      },\n      800,\n      'easeLinear',\n      500\n    );\n  }\n\n  private adjustPosition(la, lb, shape) {\n    const origin = shape.get('origin');\n    const shapeMinX = origin.x[0];\n    const shapeMaxX = origin.x[1];\n    const shapeWidth = Math.abs(shapeMaxX - shapeMinX);\n    const panelRange = this.view.coordinateBBox;\n    const boxes = [la.getBBox(), lb.getBBox()];\n    let ax = la.attr('x');\n    let bx = lb.attr('x');\n    if (this.options.adjustPosition && this.options.position === 'inner') {\n      const totalLength = boxes[0].width + boxes[1].width;\n      const isOverlap = boxes[0].maxX - boxes[1].minX > 2;\n      const isTooShort = totalLength > shapeWidth;\n      if (isOverlap || isTooShort) {\n        ax = shapeMinX - this.options.offsetX;\n        la.attr('fill', this.options.leftStyle.fill);\n        la.attr('textAlign', 'right');\n        boxes[0] = la.getBBox();\n        bx = shapeMaxX + this.options.offsetX;\n        lb.attr('fill', this.options.rightStyle.fill);\n        lb.attr('textAlign', 'left');\n        boxes[1] = lb.getBBox();\n      }\n    }\n    if (boxes[0].minX < panelRange.minX) {\n      ax = panelRange.minX + DEFAULT_OFFSET;\n      la.attr('textAlign', 'left');\n    }\n    la.attr('x', ax);\n    lb.attr('x', bx);\n    this.plot.canvas.draw();\n  }\n\n  private getGeometry() {\n    return find(this.view.geometries, (geom) => geom.type === 'interval') as Geometry;\n  }\n}\n"]}