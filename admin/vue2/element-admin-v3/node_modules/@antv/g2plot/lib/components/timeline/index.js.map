{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../src/components/timeline/index.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @file 基于 G 的播放轴组件\n * @author blackganglion\n */\n\nimport { IShape, Event, IGroup } from '@antv/g-base';\nimport { deepMix, findIndex, get } from '@antv/util';\nimport Button from './button';\nimport BaseComponent, { BaseComponentConfig } from '../base';\n\nconst TIMELINE_START = 'timelinestart';\nconst TIMELINE_CHANGE = 'timelinechange';\nconst TIMELINE_END = 'timelineend';\nconst TIMELINE_UPDATE = 'timelineupdate';\n\nconst PADDING_LEFT = 20;\nconst PADDING_RIGHT = 20;\n\n/** 播放轴配置项 */\ninterface TimeLineCfg extends BaseComponentConfig {\n  /** 播放轴位置数据 */\n  readonly x: number;\n  readonly y: number;\n  readonly width: number;\n  readonly height: number;\n  /** 刻度值 */\n  readonly ticks: string[];\n  /** 播放速度，1 个 tick 花费时间 */\n  readonly speed?: number;\n  /** 默认当前刻度值 */\n  readonly defaultCurrentTick?: string;\n  /** 是否循环播放 */\n  readonly loop?: boolean;\n}\n\n/**\n * 参考示例\n * https://www.gapminder.org/tools/#$state$time$value=1870&delay:100;;&chart-type=bubbles\n */\nexport default class TimeLine extends BaseComponent<TimeLineCfg> {\n  /** 是否处于播放状态 */\n  public isPlay: boolean;\n  /** 当前处于刻度值 */\n  private currentTick: string;\n  /** 刻度位置预处理 */\n  private tickPosList: number[];\n\n  /** 组件 */\n  private timeLineButton: Button;\n  private timeLine: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n    shape: IShape;\n    textList: IShape[];\n  };\n  private timeSelect: IShape;\n  private timeSelectText: IShape;\n\n  /** 偏移量 */\n  private prevX: number;\n\n  /** 动画 id */\n  private playHandler: number;\n\n  constructor(cfg: TimeLineCfg) {\n    super(\n      deepMix(\n        {},\n        {\n          speed: 1,\n          loop: false,\n        },\n        cfg\n      )\n    );\n  }\n\n  protected renderInner(group: IGroup) {\n    const { ticks, defaultCurrentTick } = this.config;\n\n    if (ticks && ticks.length) {\n      this.currentTick = this.config.ticks.includes(defaultCurrentTick) ? defaultCurrentTick : ticks[0];\n      this.renderPlayButton(group);\n      this.renderTimeLine(group);\n      this.renderTimeSelect(group, this.currentTick);\n      this.initEvent();\n    }\n  }\n\n  // 更新配置\n  public update(cfg: Partial<TimeLineCfg>) {\n    super.update(cfg);\n    // 更新时需要触发一次，来过滤数据\n    this.emit(TIMELINE_UPDATE, this.currentTick);\n  }\n\n  public destroy() {\n    super.destroy();\n    this.timeLineButton.destroy();\n    this.timeLineButton.off();\n    this.timeSelect.off();\n    if (this.playHandler) {\n      window.cancelAnimationFrame(this.playHandler);\n    }\n  }\n\n  private renderPlayButton(group: IGroup) {\n    const { height, x, y } = this.config;\n    const ratio = 0.8;\n    const r = (height / 2) * ratio;\n    if (this.timeLineButton) {\n      this.timeLineButton.update({\n        x: x + r,\n        y: y + r + (height * (1 - ratio)) / 2,\n        r,\n      });\n    } else {\n      this.timeLineButton = new Button({\n        container: group,\n        x: x + r,\n        y: y + r + (height * (1 - ratio)) / 2,\n        r,\n        isPlay: this.isPlay,\n      });\n      this.timeLineButton.init();\n    }\n    this.timeLineButton.render();\n  }\n\n  private getTimeLinePath() {\n    const { x, y, width, height } = this.timeLine;\n    const r = height / 2;\n\n    if (width > 0) {\n      return (\n        `M${x}, ${y}` +\n        `A${r},${r} 90 0,0 ${x},${y + height}` +\n        `L${x + width}, ${y + height}` +\n        `A${r},${r} 90 0,0 ${x + width},${y}` +\n        `L${x}, ${y}`\n      );\n    }\n\n    return [];\n  }\n\n  private renderTimeLine(group: IGroup) {\n    const { width, height, ticks, x, y } = this.config;\n\n    if (!this.timeLine) {\n      this.timeLine = {} as any;\n    }\n\n    /** 默认高度是真实高度 15% */\n    this.timeLine.height = height * 0.15;\n    this.timeLine.x = x + height + PADDING_LEFT;\n    this.timeLine.y = y + (height / 2 - this.timeLine.height / 2);\n    this.timeLine.width = width - this.timeLine.x - PADDING_RIGHT;\n\n    if (this.timeLine && this.timeLine.shape) {\n      this.timeLine.shape.attr('path', this.getTimeLinePath());\n    } else {\n      this.timeLine.shape = group.addShape('path', {\n        attrs: {\n          path: this.getTimeLinePath(),\n          fill: '#607889',\n          opacity: 0.2,\n        },\n      });\n    }\n\n    const interval = this.timeLine.width / (ticks.length - 1);\n    this.tickPosList = [];\n    if (this.timeLine.textList && this.timeLine.textList.length) {\n      this.timeLine.textList.forEach((text) => {\n        text.destroy();\n      });\n    }\n    let lastX = -Infinity;\n    this.timeLine.textList = ticks.map((tick, index) => {\n      this.tickPosList.push(this.timeLine.x + index * interval);\n\n      const text = group.addShape('text', {\n        attrs: {\n          x: this.timeLine.x + index * interval,\n          y: this.timeLine.y + this.timeLine.height + 5,\n          text: tick,\n          textAlign: 'center',\n          textBaseline: 'top',\n          fill: '#607889',\n          opacity: 0.35,\n        },\n      });\n\n      const bbox = text.getBBox();\n\n      // 抽样，标签与标签间距不小于 10\n      if (bbox.minX > lastX) {\n        text.show();\n        lastX = bbox.minX + bbox.width + 10;\n      } else {\n        text.hide();\n      }\n\n      return text;\n    });\n  }\n\n  private renderTimeSelect(group: IGroup, tickValue: string) {\n    const { ticks, height } = this.config;\n    const interval = this.timeLine.width / (ticks.length - 1);\n    const index = findIndex(ticks, (tick) => tick === tickValue);\n    const x = this.timeLine.x + index * interval;\n    const y = this.config.y + height / 2;\n    const r = height * 0.15;\n\n    if (this.timeSelect) {\n      this.timeSelect.attr('x', x);\n      this.timeSelect.attr('y', y);\n      this.timeSelect.attr('r', r);\n    } else {\n      this.timeSelect = group.addShape('circle', {\n        attrs: {\n          x,\n          y,\n          r,\n          fill: '#607889',\n        },\n      });\n    }\n\n    if (this.timeSelectText) {\n      this.timeSelectText.attr('x', x);\n      this.timeSelectText.attr('y', y - height * 0.15 - 14);\n      this.timeSelectText.attr('text', this.currentTick);\n    } else {\n      this.timeSelectText = group.addShape('text', {\n        attrs: {\n          x,\n          y: y - height * 0.15 - 14,\n          text: this.currentTick,\n          textAlign: 'center',\n          textBaseline: 'top',\n          fill: '#607889',\n        },\n      });\n    }\n  }\n\n  /** 输入当前圆点位置，输出离哪个 tick 的位置最近 */\n  private adjustTickIndex(timeSelectX: number) {\n    for (let i = 0; i < this.tickPosList.length - 1; i++) {\n      if (this.tickPosList[i] <= timeSelectX && timeSelectX <= this.tickPosList[i + 1]) {\n        return Math.abs(this.tickPosList[i] - timeSelectX) < Math.abs(timeSelectX - this.tickPosList[i + 1])\n          ? i\n          : i + 1;\n      }\n    }\n  }\n\n  /** 拖动或自动播放过程中，设置 TimeSelect 的位置 */\n  private setTimeSelectX(offsetX: number) {\n    let timeSelectX = this.timeSelect.attr('x') + offsetX;\n    // 防止左右溢出\n    if (timeSelectX < this.timeLine.x) {\n      timeSelectX = this.timeLine.x;\n    }\n    if (timeSelectX > this.timeLine.x + this.timeLine.width) {\n      timeSelectX = this.timeLine.x + this.timeLine.width;\n      // 正在播放场景\n      if (this.isPlay) {\n        // 如果是循环\n        if (this.config.loop) {\n          // 当前滑动点已经处于最后一个 tick 上，才能重置回去，继续循环\n          if (this.timeSelect.attr('x') === this.timeLine.x + this.timeLine.width) {\n            timeSelectX = this.timeLine.x;\n          }\n        } else {\n          this.isPlay = false;\n          this.changePlayStatus();\n        }\n      }\n    }\n    this.timeSelect.attr('x', timeSelectX);\n    this.timeSelectText.attr('x', timeSelectX);\n\n    const index = this.adjustTickIndex(timeSelectX);\n    if (this.currentTick !== this.config.ticks[index]) {\n      this.currentTick = this.config.ticks[index];\n      this.timeSelectText.attr('text', this.currentTick);\n      this.emit(TIMELINE_CHANGE, this.currentTick);\n    }\n\n    this.getCanvas().draw();\n  }\n\n  /** 同步圆点到 currnentTick */\n  private syncCurrnentTick() {\n    const { ticks } = this.config;\n    const interval = this.timeLine.width / (ticks.length - 1);\n    const index = findIndex(ticks, (tick) => tick === this.currentTick);\n    const x = this.timeLine.x + index * interval;\n    this.timeSelect.attr('x', x);\n    this.timeSelectText.attr('x', x);\n    this.getCanvas().draw();\n  }\n\n  private onTimeSelectMouseMove = (e: MouseEvent) => {\n    e.stopPropagation();\n    e.preventDefault();\n\n    const x = get(e, 'touches.0.pageX', e.pageX);\n    const offsetX = x - this.prevX;\n\n    this.setTimeSelectX(offsetX);\n\n    this.prevX = x;\n  };\n\n  private onTimeSelectMouseUp = () => {\n    this.syncCurrnentTick();\n\n    this.emit(TIMELINE_END, null);\n\n    // 取消事件\n    const containerDOM = this.getCanvas().get('container');\n    if (containerDOM) {\n      containerDOM.removeEventListener('mousemove', this.onTimeSelectMouseMove);\n      containerDOM.removeEventListener('mouseup', this.onTimeSelectMouseUp);\n      // 防止滑动到 canvas 外部之后，状态丢失\n      containerDOM.removeEventListener('mouseleave', this.onTimeSelectMouseUp);\n      // 移动端事件\n      containerDOM.removeEventListener('touchmove', this.onTimeSelectMouseMove);\n      containerDOM.removeEventListener('touchend', this.onTimeSelectMouseUp);\n      containerDOM.removeEventListener('touchcancel', this.onTimeSelectMouseUp);\n    }\n  };\n\n  private onTimeSelectMouseDown = (e: Event) => {\n    // 取出原生事件\n    const event = e.originalEvent as MouseEvent;\n\n    event.stopPropagation();\n    event.preventDefault();\n\n    if (this.isPlay === false) {\n      this.emit(TIMELINE_START, null);\n    } else {\n      // 取消播放状态\n      this.isPlay = false;\n      // 拖动过程中的播放暂停不需要调整 tick 位置，防止偏移\n      this.changePlayStatus(false);\n    }\n\n    this.prevX = get(event, 'touches.0.pageX', event.pageX);\n\n    // 开始滑动的时候，绑定 move 和 up 事件\n    const containerDOM = this.getCanvas().get('container');\n    containerDOM.addEventListener('mousemove', this.onTimeSelectMouseMove);\n    containerDOM.addEventListener('mouseup', this.onTimeSelectMouseUp);\n    containerDOM.addEventListener('mouseleave', this.onTimeSelectMouseUp);\n    // 移动端事件\n    containerDOM.addEventListener('touchmove', this.onTimeSelectMouseMove);\n    containerDOM.addEventListener('touchend', this.onTimeSelectMouseUp);\n    containerDOM.addEventListener('touchcancel', this.onTimeSelectMouseUp);\n  };\n\n  private startPlay() {\n    return window.requestAnimationFrame(() => {\n      const { speed, ticks } = this.config;\n      const { width } = this.timeLine;\n\n      const tickInterval = width / ticks.length;\n      const offsetX = tickInterval / ((speed * 1000) / 60);\n\n      this.setTimeSelectX(offsetX);\n\n      if (this.isPlay) {\n        this.playHandler = this.startPlay();\n      }\n    });\n  }\n\n  public changePlayStatus(isSync = true) {\n    this.timeLineButton.update({\n      isPlay: this.isPlay,\n    });\n    if (this.isPlay) {\n      // 开始播放\n      this.playHandler = this.startPlay();\n      this.emit(TIMELINE_START, null);\n    } else {\n      // 结束播放\n      if (this.playHandler) {\n        window.cancelAnimationFrame(this.playHandler);\n        if (isSync) {\n          this.syncCurrnentTick();\n          this.emit(TIMELINE_END, null);\n        }\n      }\n    }\n    this.getCanvas().draw();\n  }\n\n  private initEvent() {\n    /** 播放/暂停事件 */\n    this.timeLineButton.off('click');\n    this.timeLineButton.on('click', () => {\n      this.isPlay = !this.isPlay;\n      this.changePlayStatus();\n    });\n\n    /** 播放轴上圆点滑动事件 */\n    this.timeSelect.off('mousedown');\n    this.timeSelect.on('mousedown', (event) => {\n      this.onTimeSelectMouseDown(event);\n    });\n  }\n}\n"]}