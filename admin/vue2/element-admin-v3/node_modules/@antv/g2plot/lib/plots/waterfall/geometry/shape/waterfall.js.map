{"version":3,"file":"waterfall.js","sourceRoot":"","sources":["../../../../../src/plots/waterfall/geometry/shape/waterfall.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Create By Bruce Too\n * On 2020-02-18\n */\nimport { get } from '@antv/util';\nimport { IGroup, registerShape, Point, ShapeInfo } from '../../../../dependents';\n\nfunction getStyle(cfg: ShapeInfo, isStroke: boolean, isFill: boolean) {\n  const { style, defaultStyle, color } = cfg;\n  const attrs = {\n    ...defaultStyle,\n    ...style,\n  };\n  if (color) {\n    if (isStroke) {\n      attrs.stroke = color;\n    }\n    if (isFill) {\n      attrs.fill = color;\n    }\n  }\n  return attrs;\n}\n\nfunction getRectPath(points: Point[]) {\n  const path = [];\n  const firstPoint = points[0];\n  path.push(['M', firstPoint.x, firstPoint.y]);\n  for (let i = 1, len = points.length; i < len; i++) {\n    path.push(['L', points[i].x, points[i].y]);\n  }\n  path.push(['L', firstPoint.x, firstPoint.y]); // 需要闭合\n  path.push(['z']);\n  return path;\n}\n\n// @ts-ignore\nregisterShape('interval', 'waterfall', {\n  // @ts-ignore\n  draw(cfg: ShapeInfo, container: IGroup) {\n    const style = getStyle(cfg, false, true);\n    const path = this.parsePath(getRectPath(cfg.points as Point[]));\n    const shape = container.addShape('path', {\n      attrs: {\n        ...style,\n        path,\n      },\n      name: 'interval',\n    });\n    const leaderLine = get(cfg.style, 'leaderLine');\n    if (leaderLine && leaderLine.visible) {\n      const lineStyle = leaderLine.style || {};\n      // 2. 虚线连线\n      if (cfg.nextPoints) {\n        let linkPath = [\n          // @ts-ignore\n          ['M', cfg.points[2].x, cfg.points[2].y],\n          // @ts-ignore\n          ['L', cfg.nextPoints[0].x, cfg.nextPoints[0].y],\n        ];\n        linkPath = this.parsePath(linkPath);\n        container.addShape('path', {\n          attrs: {\n            path: linkPath,\n            stroke: '#d3d3d3',\n            lineDash: [4, 2],\n            lineWidth: 1,\n            ...lineStyle,\n          },\n          name: 'leader-line',\n        });\n      }\n    }\n    return shape;\n  },\n});\n"]}