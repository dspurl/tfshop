{"version":3,"file":"layer.js","sourceRoot":"","sources":["../../../src/plots/grouped-rose/layer.ts"],"names":[],"mappings":";;;AAAA,mCAAqC;AACrC,4CAAqD;AAErD,gEAA0D;AAQ1D;IAAyG,4CAAY;IAArH;QAAA,qEA6DC;QAhCQ,UAAI,GAAW,aAAa,CAAC;QAC7B,cAAQ,GAAW,MAAM,CAAC;;IA+BnC,CAAC;IA5De,kCAAiB,GAA/B;QACE,OAAO,cAAO,CAAC,EAAE,EAAE,OAAM,iBAAiB,WAAE,EAAE;YAC5C,KAAK,EAAE;gBACL,OAAO,EAAE,IAAI;gBACb,IAAI,EAAE;oBACJ,OAAO,EAAE,KAAK;iBACf;gBACD,QAAQ,EAAE;oBACR,OAAO,EAAE,KAAK;iBACf;gBACD,IAAI,EAAE;oBACJ,OAAO,EAAE,IAAI;oBACb,SAAS,EAAE,KAAK;oBAChB,KAAK,EAAE;wBACL,SAAS,EAAE,GAAG;qBACf;iBACF;gBACD,KAAK,EAAE;oBACL,MAAM,EAAE,CAAC;oBACT,UAAU,EAAE,IAAI;iBACjB;aACF;YACD,KAAK,EAAE;gBACL,OAAO,EAAE,KAAK;aACf;SACF,CAAC,CAAC;IACL,CAAC;IAKM,wCAAa,GAApB;QACU,IAAA,UAAU,GAAK,IAAI,CAAC,OAAO,WAAjB,CAAkB;QACpC,IAAI,UAAU,EAAE;YACd,OAAO,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;SAC9C;IACH,CAAC;IAES,2CAAgB,GAA1B;QACE,OAAO;YACL;gBACE,IAAI,EAAE,OAAO;gBACb,WAAW,EAAE,CAAC;aACf;SACF,CAAC;IACJ,CAAC;IAES,0CAAe,GAAzB;QACE,IAAI,CAAC,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;QACvB,IAAM,cAAc,GAAQ,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC;QACjD,IAAI,cAAc,CAAC,MAAM,EAAE;YACzB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,cAAc,CAAC,MAAM,CAAC;SAClD;QACD,IAAI,cAAc,CAAC,SAAS,EAAE;YAC5B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,cAAc,CAAC,SAAS,CAAC;YACtD,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE;gBAC1B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;aAC5G;SACF;IACH,CAAC;IACH,uBAAC;AAAD,CAAC,AA7DD,CAAyG,eAAS,GA6DjH;;AAED,yBAAgB,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC","sourcesContent":["import { deepMix } from '@antv/util';\nimport { registerPlotType } from '../../base/global';\nimport { LayerConfig } from '../../base/layer';\nimport RoseLayer, { RoseViewConfig } from '../rose/layer';\n\nexport interface GroupedRoseViewConfig extends RoseViewConfig {\n  groupField: string;\n}\n\nexport interface GroupedRoseLayerConfig extends GroupedRoseViewConfig, LayerConfig {}\n\nexport default class GroupedRoseLayer<T extends GroupedRoseLayerConfig = GroupedRoseLayerConfig> extends RoseLayer<T> {\n  public static getDefaultOptions() {\n    return deepMix({}, super.getDefaultOptions(), {\n      xAxis: {\n        visible: true,\n        line: {\n          visible: false,\n        },\n        tickLine: {\n          visible: false,\n        },\n        grid: {\n          visible: true,\n          alignTick: false,\n          style: {\n            lineWidth: 0.5,\n          },\n        },\n        label: {\n          offset: 5,\n          autoRotate: true,\n        },\n      },\n      yAxis: {\n        visible: false,\n      },\n    });\n  }\n\n  public type: string = 'groupedRose';\n  public baseType: string = 'rose';\n\n  public getColorScale() {\n    const { groupField } = this.options;\n    if (groupField) {\n      return this.view.getScaleByField(groupField);\n    }\n  }\n\n  protected adjustRoseAdjust() {\n    return [\n      {\n        type: 'dodge',\n        marginRatio: 1,\n      },\n    ];\n  }\n\n  protected geometryTooltip() {\n    this.rose.tooltip = {};\n    const tooltipOptions: any = this.options.tooltip;\n    if (tooltipOptions.fields) {\n      this.rose.tooltip.fields = tooltipOptions.fields;\n    }\n    if (tooltipOptions.formatter) {\n      this.rose.tooltip.callback = tooltipOptions.formatter;\n      if (!tooltipOptions.fields) {\n        this.rose.tooltip.fields = [this.options.radiusField, this.options.categoryField, this.options.groupField];\n      }\n    }\n  }\n}\n\nregisterPlotType('groupedRose', GroupedRoseLayer);\n"]}