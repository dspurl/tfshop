{"version":3,"file":"core.js","sourceRoot":"","sources":["../../src/interaction/core.ts"],"names":[],"mappings":"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","sourcesContent":["import { assign, each, wrapBehavior } from '@antv/util';\nimport { View, ICanvas } from '../dependents';\n\ninterface InteractionCfg {\n  view: View;\n  startEvent?: string;\n  processEvent?: string;\n  endEvent?: string;\n  resetEvent?: string;\n}\n\nexport interface InteractionConstructor {\n  new (cfg: any): Interaction;\n}\n\nconst EVENT_TYPES = ['start', 'process', 'end', 'reset'];\n\nexport default abstract class Interaction {\n  view: View;\n  protected canvas: ICanvas;\n  startEvent: string;\n  processEvent: string;\n  endEvent: string;\n  resetEvent: string;\n  private _eventHandlers: any[];\n  constructor(cfg: InteractionCfg) {\n    const defaultCfg = this.getDefaultCfg();\n    assign(this, defaultCfg, cfg);\n    this.canvas = this.view.canvas;\n    this._eventHandlers = [];\n    this._bindEvents();\n  }\n\n  protected getDefaultCfg() {\n    return {\n      startEvent: 'mousedown',\n      processEvent: 'mousemove',\n      endEvent: 'mouseup',\n      resetEvent: 'dblclick',\n    };\n  }\n\n  private _start(ev) {\n    this.preStart(ev);\n    this.start(ev);\n    this.afterStart(ev);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected preStart(ev): void {\n    return;\n  }\n\n  protected abstract start(ev): void;\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected afterStart(ev): void {\n    return;\n  }\n\n  private _process(ev) {\n    this.preProcess(ev);\n    this.process(ev);\n    this.afterProcess(ev);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected preProcess(ev): void {\n    return;\n  }\n\n  //eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected process(ev): void {\n    return;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected afterProcess(ev): void {\n    return;\n  }\n\n  private _end(ev) {\n    this.preEnd(ev);\n    this.end(ev);\n    this.afterEnd(ev);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected preEnd(ev): void {\n    return;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected end(ev): void {\n    return;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected afterEnd(ev): void {\n    return;\n  }\n\n  private _reset(ev?: any) {\n    this.preReset(ev);\n    this.reset(ev);\n    this.afterReset(ev);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected preReset(ev?: any): void {\n    return;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected reset(ev?: any): void {\n    return;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected afterReset(ev?: any): void {\n    return;\n  }\n\n  private _bindEvents() {\n    each(EVENT_TYPES, (type) => {\n      const eventName = this[`${type}Event`];\n      const handler = wrapBehavior(this, `_${type}`);\n      this.view.on(eventName, handler);\n      this._eventHandlers.push({ type: eventName, handler });\n    });\n  }\n\n  private _unbindEvents() {\n    const eventHandlers = this._eventHandlers;\n    each(eventHandlers, (eh) => {\n      this.view.off(eh.type, eh.handler);\n    });\n  }\n\n  public destroy() {\n    this._unbindEvents();\n    this._reset();\n  }\n}\n"]}