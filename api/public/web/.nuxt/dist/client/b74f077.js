(window.webpackJsonp=window.webpackJsonp||[]).push([[29,30],{577:function(t,e,n){"use strict";n.r(e);n(46),n(38),n(72),n(73);var r=n(34),o=n(7),l=(n(36),n(18),n(291),n(192),n(193),n(294),n(45),n(124));function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}e.default={layout:"cart",head:function(){return{title:"我的购物车-DSSHOP商城-跨终端商城解决方案"}},data:function(){return{loading:!0,cartList:[],cartOriginalList:[],invalidGood:[],total:0,allChecked:!0,empty:!0,multipleSelection:[]}},mounted:function(){$nuxt.$store.commit("setCartTitle","我的购物车"),$nuxt.$store.state.hasLogin&&this.getList()},methods:{getList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,t.cartList=[],t.invalidGood=[],e.next=5,Object(l.j)().then((function(e){t.store.set("DSSHOP-PC-CartList",e),t.cartOriginalList=e,e.length>0?t.empty=!1:t.empty=!0;var n=function(n){e[n].good_sku&&(e[n].specification="",e[n].good_sku.skus.forEach((function(t){e[n].specification?e[n].specification+=t.v+";":e[n].specification=t.v+";"})),e[n].specification=e[n].specification.substr(0,e[n].specification.length-1)),1!==e[n].good.is_delete&&1===e[n].good.is_show||(e[n].invalid=!0),!0===e[n].invalid?t.invalidGood.push(d(d({},e[n]),{},{index:n})):t.cartList.push(d(d({},e[n]),{},{index:n}))};for(var r in e)n(r);t.$nextTick((function(){!1===t.empty&&t.handleCheckAllChange()})),t.loading=!1})).catch((function(){t.loading=!1}));case 5:case"end":return e.stop()}}),e)})))()},calcTotal:function(){var t=this.multipleSelection,e=0;t.forEach((function(t){e+=t.price*t.number})),this.total=Number(e.toFixed(2))},handleSelectionChange:function(t){this.multipleSelection=t,this.calcTotal()},handleCheckAllChange:function(){this.$refs.table.toggleAllSelection(),this.calcTotal()},createOrder:function(){this.multipleSelection.length<=0?this.$message({message:"请选择商品",type:"error"}):(this.store.set("DSSHOP-PC-OrderList",this.multipleSelection),$nuxt.$router.push("/indent/create"))},numberChange:function(t){this.cartOriginalList[t].number=this.cartList[t].number,this.store.set("DSSHOP-PC-CartList",this.cartOriginalList),Object(l.a)(this.cartOriginalList),this.calcTotal()},deleteInvalidGood:function(t){var e=this;this.$confirm("是否移除该商品？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){e.cartOriginalList.splice(e.invalidGood[t].index,1),Object.values(e.cartOriginalList).length>0?e.store.set("DSSHOP-PC-CartList",e.cartOriginalList):e.store.remove("DSSHOP-PC-CartList"),Object(l.a)(e.cartOriginalList).then((function(){e.getList()})),e.invalidGood.splice(t,1)})).catch((function(){}))},deleteCartItem:function(t){var e=this;this.$confirm("是否移除该商品？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){e.cartOriginalList.splice(e.cartList[t].index,1),Object.values(e.cartOriginalList).length>0?e.store.set("DSSHOP-PC-CartList",e.cartOriginalList):e.store.remove("DSSHOP-PC-CartList"),Object(l.a)(e.cartOriginalList).then((function(){e.getList()})),e.cartList.splice(t,1)})).catch((function(){}))},clearCart:function(){var t=this;this.$confirm("是否移除所选商品？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){t.multipleSelection.forEach((function(e){t.cartList.forEach((function(n,r){e.good_sku_id?e.good_sku_id===n.good_sku_id&&(delete t.cartOriginalList[n.index],t.cartList.splice(r,1)):e.good_id===n.good_id&&(delete t.cartOriginalList[n.index],t.cartList.splice(r,1))}))})),t.cartOriginalList=t.cartOriginalList.filter((function(t){return t})),Object.values(t.cartOriginalList).length>0?t.store.set("DSSHOP-PC-CartList",t.cartOriginalList):t.store.remove("DSSHOP-PC-CartList"),Object(l.a)(t.cartOriginalList).then((function(){t.getList()}))})).catch((function(){}))}}}},578:function(t,e,n){var content=n(657);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(12).default)("c11441da",content,!0,{sourceMap:!1})},655:function(t,e,n){t.exports=n.p+"img/empty-cart.025b92e.png"},656:function(t,e,n){"use strict";n(578)},657:function(t,e,n){var r=n(11)(!1);r.push([t.i,".invalid-title[data-v-96326bf0]{padding:20px 0;font-size:26px;color:#ccc;text-align:center}.invalidTable[data-v-96326bf0]{margin-top:20px}.cart-list[data-v-96326bf0]{padding:30px 0}.cart-list .specification[data-v-96326bf0]{color:#999}.cart-operation[data-v-96326bf0]{margin-top:20px;background-color:#fff;display:flex;line-height:40px;font-size:12px}.cart-operation .left[data-v-96326bf0]{flex:1;padding-left:20px;color:#757575}.cart-operation .left .delete[data-v-96326bf0]{cursor:pointer}.cart-operation .left .delete[data-v-96326bf0]:hover,.cart-operation .left .number[data-v-96326bf0]{color:#fa524c}.cart-operation .right[data-v-96326bf0]{width:400px;justify-content:flex-end;display:flex}.cart-operation .right .total[data-v-96326bf0]{margin-right:30px;color:#fa524c}.cart-operation .right .total span[data-v-96326bf0]{font-size:28px}.cart-operation .right .settlement[data-v-96326bf0]{width:150px}.cart[data-v-96326bf0]{margin-top:100px;margin-bottom:100px;display:flex;position:relative}.cart .empty-cart img[data-v-96326bf0]{width:500px}.cart .instructions[data-v-96326bf0]{margin:160px 0 0 50px}.cart .instructions .title[data-v-96326bf0]{font-size:35px;color:#b0b0b0;line-height:55px;font-weight:700}.cart .instructions .login[data-v-96326bf0]{font-size:18px;line-height:45px;color:#b0b0b0}.cart .instructions .operation[data-v-96326bf0]{margin-top:20px}",""]),t.exports=r},750:function(t,e,n){"use strict";n.r(e);var r=n(577).default,o=(n(656),n(6)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"box"},[t.empty?[r("div",{staticClass:"cart container"},[r("div",{staticClass:"empty-cart"},[r("img",{attrs:{src:n(655)}})]),t._v(" "),r("div",{staticClass:"instructions"},[r("div",{staticClass:"title"},[t._v("您的购物车还是空的！")]),t._v(" "),t.$store.state.hasLogin?t._e():r("div",{staticClass:"login"},[t._v("登录后将显示您之前加入的商品")]),t._v(" "),r("div",{staticClass:"operation"},[t.$store.state.hasLogin?[r("NuxtLink",{staticClass:"li",attrs:{to:"/category/list"}},[r("el-button",{attrs:{type:"danger"}},[t._v("马上去购物")])],1)]:[r("NuxtLink",{staticClass:"li",attrs:{to:"/pass/login"}},[r("el-button",{attrs:{type:"danger"}},[t._v("立即登录")])],1),t._v(" "),r("NuxtLink",{staticClass:"li",attrs:{to:"/category/list"}},[r("el-button",{attrs:{type:"danger",plain:""}},[t._v("马上去购物")])],1)]],2)])])]:[r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"cart-list container"},[r("el-table",{ref:"table",staticClass:"table",attrs:{data:t.cartList},on:{"selection-change":t.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t._v(" "),r("el-table-column",{attrs:{align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("NuxtLink",{attrs:{to:{path:"/product/detail/"+e.row.good_id}}},[r("el-image",{staticClass:"image",attrs:{src:t._f("smallImage")(e.row.img,80),fit:"cover"}})],1)]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"商品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("NuxtLink",{attrs:{to:{path:"/product/detail/"+e.row.good_id}}},[r("p",[t._v(t._s(e.row.name))]),t._v(" "),r("p",{staticClass:"specification"},[t._v(t._s(e.row.specification))])])]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"单价",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(t._f("thousands")(e.row.price))+"\n          ")]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"数量",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-input-number",{attrs:{size:"mini",min:1,max:e.row.good_sku.inventory},on:{change:function(n){return t.numberChange(e.$index)}},model:{value:e.row.number,callback:function(n){t.$set(e.row,"number",n)},expression:"scope.row.number"}})]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"小计",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(t._f("thousands")(e.row.price*e.row.number))+"\n          ")]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"操作",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"移除商品",placement:"top-start"}},[r("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){return n.stopPropagation(),t.deleteCartItem(e.$index)}}})],1)]}}])})],1),t._v(" "),r("div",{staticClass:"cart-operation"},[r("div",{staticClass:"left"},[r("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:t.handleCheckAllChange}},[t._v("全选/全不选")]),t._v(" "),r("el-divider",{attrs:{direction:"vertical"}}),t._v(" "),r("span",{staticClass:"delete",on:{click:t.clearCart}},[t._v("删除")]),t._v(" "),r("el-divider",{attrs:{direction:"vertical"}}),t._v(" "),r("span",[t._v("共 "),r("span",{staticClass:"number"},[t._v(t._s(t.cartList.length))]),t._v(" 件商品，已选择 "),r("span",{staticClass:"number"},[t._v(t._s(t.multipleSelection.length))]),t._v("件")])],1),t._v(" "),r("div",{staticClass:"right"},[r("div",{staticClass:"total"},[t._v("合计："),r("span",[t._v(t._s(t.total))]),t._v("元")]),t._v(" "),r("el-button",{staticClass:"settlement",attrs:{type:"danger",disabled:t.total<=0},on:{click:t.createOrder}},[t._v("去结算")])],1)]),t._v(" "),t.invalidGood.length?[r("h3",{staticClass:"invalid-title"},[t._v("已失效的商品")]),t._v(" "),r("el-table",{ref:"invalidTable",staticClass:"invalidTable",attrs:{data:t.invalidGood}},[r("el-table-column",{attrs:{align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("NuxtLink",{attrs:{to:{path:"/product/detail/"+e.row.good_id}}},[r("el-image",{staticClass:"image",attrs:{src:t._f("smallImage")(e.row.img,80),fit:"cover"}})],1)]}}],null,!1,138529428)}),t._v(" "),r("el-table-column",{attrs:{label:"商品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("NuxtLink",{attrs:{to:{path:"/product/detail/"+e.row.good_id}}},[r("p",[t._v(t._s(e.row.name))]),t._v(" "),r("p",{staticClass:"specification"},[t._v(t._s(e.row.specification))])])]}}],null,!1,270465265)}),t._v(" "),r("el-table-column",{attrs:{label:"单价",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("thousands")(e.row.price))+"\n            ")]}}],null,!1,912411108)}),t._v(" "),r("el-table-column",{attrs:{label:"数量",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.number)+"\n            ")]}}],null,!1,4147131710)}),t._v(" "),r("el-table-column",{attrs:{label:"小计",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("thousands")(e.row.price*e.row.number))+"\n            ")]}}],null,!1,1182163340)}),t._v(" "),r("el-table-column",{attrs:{label:"操作",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"移除商品",placement:"top-start"}},[r("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){return t.deleteInvalidGood(e.$index)}}})],1)]}}],null,!1,847168811)})],1)]:t._e()],2)]],2)}),[],!1,null,"96326bf0",null);e.default=component.exports}}]);